{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\kim-a\\\\Documents\\\\DiceyTeck\\\\MTG Scanner BACKUP\\\\src\\\\Scanner.js\",\n  _s = $RefreshSig$();\n// Scanner.js - MTG Scanner with Smart Cooldown System - COMPLETE INTEGRATED VERSION\nimport React, { useState, useRef, useEffect } from 'react';\nimport ClaudeVisionService from './ClaudeVisionService';\nimport CardDisplayUI from './CardDisplayUI';\nimport DeckManager from './DeckManager';\nimport MTGKnowledgeBase from './MTGKnowledgeBase';\nimport EditionSelector from './EditionSelector';\nimport './CardDisplay.css';\n\n// ðŸ”¥ Smart Cooldown System Class\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nclass MTGScannerCooldown {\n  constructor() {\n    this.lastDetectedCard = null;\n    this.lastDetectionTime = 0;\n    this.lastApiCall = 0;\n    this.consecutiveDetections = 0;\n    this.isEditionSelectorOpen = false;\n\n    // Cooldown periods (in milliseconds)\n    this.SAME_CARD_COOLDOWN = 8000; // 8 seconds for same card\n    this.MIN_API_INTERVAL = 2000; // 2 seconds between API calls\n    this.FRAME_CHANGE_THRESHOLD = 0.1; // 10% frame change required\n    this.MAX_CONSECUTIVE = 3; // Max detections before longer cooldown\n\n    this.lastFrameData = null;\n  }\n\n  // Check if we should scan this frame\n  shouldScan(cardName = null) {\n    const now = Date.now();\n\n    // 1. Don't scan if edition selector is open\n    if (this.isEditionSelectorOpen) {\n      console.log(\"ðŸš« Scanning blocked: Edition selector open\");\n      return false;\n    }\n\n    // 2. Enforce minimum API interval\n    if (now - this.lastApiCall < this.MIN_API_INTERVAL) {\n      console.log(`ðŸš« Scanning blocked: API cooldown (${this.MIN_API_INTERVAL - (now - this.lastApiCall)}ms remaining)`);\n      return false;\n    }\n\n    // 3. Same card cooldown\n    if (cardName && cardName === this.lastDetectedCard) {\n      const timeSinceLastDetection = now - this.lastDetectionTime;\n      if (timeSinceLastDetection < this.SAME_CARD_COOLDOWN) {\n        console.log(`ðŸš« Scanning blocked: Same card cooldown for \"${cardName}\" (${this.SAME_CARD_COOLDOWN - timeSinceLastDetection}ms remaining)`);\n        return false;\n      }\n    }\n\n    // 4. Consecutive detection limit\n    if (this.consecutiveDetections >= this.MAX_CONSECUTIVE) {\n      console.log(`ðŸš« Scanning blocked: Max consecutive detections reached (${this.MAX_CONSECUTIVE})`);\n      return false;\n    }\n    return true;\n  }\n\n  // Check if frame has changed significantly\n  hasFrameChanged(currentFrameData) {\n    if (!this.lastFrameData) {\n      this.lastFrameData = currentFrameData;\n      return true;\n    }\n\n    // Simple frame change detection\n    const changeRatio = this.calculateFrameChange(this.lastFrameData, currentFrameData);\n    const hasChanged = changeRatio > this.FRAME_CHANGE_THRESHOLD;\n    if (hasChanged) {\n      this.lastFrameData = currentFrameData;\n    }\n    return hasChanged;\n  }\n\n  // Simple frame change calculation\n  calculateFrameChange(frame1, frame2) {\n    if (frame1.length !== frame2.length) return 1;\n    let differences = 0;\n    const sampleSize = Math.min(1000, frame1.length); // Sample for performance\n\n    for (let i = 0; i < sampleSize; i += 4) {\n      // Sample every 4th byte\n      if (Math.abs(frame1[i] - frame2[i]) > 10) {\n        // Threshold for significant change\n        differences++;\n      }\n    }\n    return differences / (sampleSize / 4);\n  }\n\n  // Record a detection\n  recordDetection(cardName) {\n    const now = Date.now();\n    if (cardName === this.lastDetectedCard) {\n      this.consecutiveDetections++;\n    } else {\n      this.consecutiveDetections = 1;\n      this.lastDetectedCard = cardName;\n    }\n    this.lastDetectionTime = now;\n    this.lastApiCall = now;\n    console.log(`âœ… Detection recorded: \"${cardName}\" (consecutive: ${this.consecutiveDetections})`);\n  }\n\n  // Reset cooldowns (call when user interaction occurs)\n  resetCooldowns() {\n    console.log(\"ðŸ”„ Cooldowns reset by user interaction\");\n    this.consecutiveDetections = 0;\n    this.lastDetectedCard = null;\n    this.lastDetectionTime = 0;\n  }\n\n  // Set edition selector state\n  setEditionSelectorOpen(isOpen) {\n    this.isEditionSelectorOpen = isOpen;\n    if (isOpen) {\n      console.log(\"ðŸŽ­ Edition selector opened - scanning paused\");\n    } else {\n      console.log(\"ðŸŽ­ Edition selector closed - scanning can resume\");\n      this.resetCooldowns(); // Reset when edition selector closes\n    }\n  }\n\n  // Get cooldown status for UI\n  getCooldownStatus() {\n    const now = Date.now();\n    return {\n      sameCardCooldown: this.lastDetectedCard ? Math.max(0, this.SAME_CARD_COOLDOWN - (now - this.lastDetectionTime)) : 0,\n      apiCooldown: Math.max(0, this.MIN_API_INTERVAL - (now - this.lastApiCall)),\n      consecutiveDetections: this.consecutiveDetections,\n      isEditionSelectorOpen: this.isEditionSelectorOpen,\n      canScan: this.shouldScan(this.lastDetectedCard)\n    };\n  }\n}\nconst Scanner = () => {\n  _s();\n  var _pendingCardData$card, _pendingCardData$card2;\n  // Core scanner state\n  const [isScanning, setIsScanning] = useState(false);\n  const [scanResult, setScanResult] = useState(null);\n  const [cameraStatus, setCameraStatus] = useState('initializing');\n  const [currentCard, setCurrentCard] = useState(null);\n  const [scanMode, setScanMode] = useState('continuous');\n\n  // Smart scanning state\n  const [continuousCount, setContinuousCount] = useState(0);\n  const [showContinueDialog, setShowContinueDialog] = useState(false);\n  const [autoSaveEnabled, setAutoSaveEnabled] = useState(true);\n\n  // ðŸ”¥ NEW: Cooldown system state\n  const [cooldownStatus, setCooldownStatus] = useState({});\n\n  // UI state\n  const [activeTab, setActiveTab] = useState('scanner');\n  const [scanHistory, setScanHistory] = useState([]);\n  const [isUIVisible, setIsUIVisible] = useState(true);\n  const [savedCards, setSavedCards] = useState([]);\n\n  // Edition selection state\n  const [showEditionSelector, setShowEditionSelector] = useState(false);\n  const [availableEditions, setAvailableEditions] = useState([]);\n  const [pendingCardData, setPendingCardData] = useState(null);\n  const [pendingScanMode, setPendingScanMode] = useState(null);\n  const [scanningPausedForSelection, setScanningPausedForSelection] = useState(false);\n\n  // AI Learning for edition preferences\n  const [editionPreferences, setEditionPreferences] = useState({});\n\n  // Collection limits and premium features\n  const [isPremiumUser, setIsPremiumUser] = useState(false);\n  const [showPaywallModal, setShowPaywallModal] = useState(false);\n  const FREE_COLLECTION_LIMIT = 100;\n\n  // Camera state with persistence\n  const [cameraError, setCameraError] = useState(null);\n  const [cameraRetryCount, setCameraRetryCount] = useState(0);\n  const [cameraInitializationComplete, setCameraInitializationComplete] = useState(false);\n\n  // Refs\n  const videoRef = useRef(null);\n  const scanIntervalRef = useRef(null);\n  const visionServiceRef = useRef(null);\n  const cameraStreamRef = useRef(null);\n  const initializationPromiseRef = useRef(null);\n\n  // ðŸ”¥ NEW: Cooldown system ref\n  const cooldownSystemRef = useRef(new MTGScannerCooldown());\n\n  // ðŸ”¥ Initialize services and camera ONCE\n  useEffect(() => {\n    console.log('ðŸ”§ Component mounting - initializing services...');\n    initializeServices();\n    loadSavedData();\n\n    // Initialize camera ONCE\n    if (!initializationPromiseRef.current) {\n      console.log('ðŸš€ Starting PERSISTENT camera initialization...');\n      initializationPromiseRef.current = setupCamera();\n    }\n\n    // Update cooldown status periodically\n    const cooldownUpdateInterval = setInterval(() => {\n      setCooldownStatus(cooldownSystemRef.current.getCooldownStatus());\n    }, 1000);\n    return () => {\n      console.log('ðŸ§¹ Component unmounting - cleaning up...');\n      clearInterval(cooldownUpdateInterval);\n      cleanup();\n    };\n  }, []);\n\n  // Handle tab switching without stopping camera\n  useEffect(() => {\n    console.log(`ðŸŽ¯ Tab switched to: ${activeTab}`);\n    if (activeTab === 'scanner' && cameraStreamRef.current && cameraStreamRef.current.active) {\n      console.log('ðŸŽ¯ Scanner tab active, ensuring video connection...');\n      if (videoRef.current && !videoRef.current.srcObject) {\n        console.log('ðŸ“· Reconnecting video element to persistent stream...');\n        videoRef.current.srcObject = cameraStreamRef.current;\n        videoRef.current.play();\n      }\n    }\n    if (activeTab !== 'scanner' && isScanning) {\n      console.log('â¸ï¸ Pausing scanning - left scanner tab (camera stays active)');\n      stopScanning();\n    }\n  }, [activeTab]);\n  const initializeServices = () => {\n    console.log('ðŸ”§ Initializing MTG Scanner Pro...');\n    try {\n      visionServiceRef.current = new ClaudeVisionService();\n      console.log('âœ… Gemini Vision Service initialized successfully');\n    } catch (error) {\n      console.error('âŒ Service initialization failed:', error);\n    }\n  };\n  const loadSavedData = () => {\n    try {\n      const saved = localStorage.getItem('mtg_saved_cards');\n      if (saved) {\n        setSavedCards(JSON.parse(saved));\n        console.log('ðŸ“ Loaded saved cards from storage');\n      }\n      const preferences = localStorage.getItem('mtg_edition_preferences');\n      if (preferences) {\n        setEditionPreferences(JSON.parse(preferences));\n        console.log('ðŸ§  Loaded edition preferences for AI learning');\n      }\n      const premiumStatus = localStorage.getItem('mtg_premium_status');\n      if (premiumStatus === 'true') {\n        setIsPremiumUser(true);\n        console.log('ðŸ’Ž Premium user status loaded');\n      }\n    } catch (error) {\n      console.error('âŒ Failed to load saved data:', error);\n    }\n  };\n\n  // Camera setup with persistence\n  const setupCamera = async () => {\n    console.log('ðŸŽ¥ Setting up PERSISTENT camera for MTG Scanner Pro...');\n    setCameraStatus('requesting');\n    setCameraError(null);\n    try {\n      if (!navigator.mediaDevices || !navigator.mediaDevices.getUserMedia) {\n        throw new Error('Camera API not supported in this browser');\n      }\n      if (cameraStreamRef.current && cameraStreamRef.current.active) {\n        console.log('ðŸ“· Camera stream already active, reusing persistent stream...');\n        if (videoRef.current && !videoRef.current.srcObject) {\n          videoRef.current.srcObject = cameraStreamRef.current;\n          videoRef.current.play();\n        }\n        setCameraStatus('ready');\n        setCameraInitializationComplete(true);\n        console.log('âœ… Camera reused successfully - PERSISTENT MODE ACTIVE');\n        return;\n      }\n      let stream = null;\n      try {\n        console.log('ðŸ“· Attempting to use Logitech C920...');\n        const logitechConstraints = {\n          video: {\n            deviceId: {\n              exact: '9b204eef73d1ed44be0ea768bfdb4c98dc4384c6cdc2fdabd82c6e863313382b'\n            },\n            width: {\n              ideal: 1280\n            },\n            height: {\n              ideal: 720\n            },\n            frameRate: {\n              ideal: 30\n            }\n          },\n          audio: false\n        };\n        stream = await navigator.mediaDevices.getUserMedia(logitechConstraints);\n        console.log('âœ… Successfully using Logitech C920!');\n      } catch (logitechError) {\n        console.log('âš ï¸ Logitech C920 not available, trying general constraints...');\n        const generalConstraints = {\n          video: {\n            width: {\n              ideal: 1280,\n              min: 320\n            },\n            height: {\n              ideal: 720,\n              min: 240\n            },\n            facingMode: {\n              ideal: 'environment'\n            },\n            frameRate: {\n              ideal: 30\n            }\n          },\n          audio: false\n        };\n        stream = await navigator.mediaDevices.getUserMedia(generalConstraints);\n        console.log('âœ… Using fallback camera settings');\n      }\n      cameraStreamRef.current = stream;\n      setCameraInitializationComplete(true);\n      if (videoRef.current) {\n        videoRef.current.srcObject = stream;\n        videoRef.current.onloadedmetadata = () => {\n          videoRef.current.play();\n          setCameraStatus('ready');\n          setCameraError(null);\n          setCameraRetryCount(0);\n          console.log('âœ… PERSISTENT Camera ready:', `${videoRef.current.videoWidth}x${videoRef.current.videoHeight}`);\n          showCameraMessage('âœ… Camera ready with smart cooldown!', 'success');\n        };\n      }\n    } catch (error) {\n      console.error('âŒ Camera setup failed:', error);\n      setCameraStatus('error');\n      handleCameraError(error);\n    }\n  };\n  const handleCameraError = error => {\n    let errorMessage = '';\n    let errorAction = '';\n    let canRetry = false;\n    switch (error.name) {\n      case 'NotAllowedError':\n        errorMessage = 'Camera permission denied';\n        errorAction = 'Please allow camera access and click \"Try Again\"';\n        canRetry = true;\n        break;\n      case 'NotFoundError':\n        errorMessage = 'No camera found';\n        errorAction = 'Please connect a camera or use a device with a camera';\n        canRetry = true;\n        break;\n      case 'NotReadableError':\n        errorMessage = 'Camera is busy';\n        errorAction = 'Please close other apps using the camera and try again';\n        canRetry = true;\n        break;\n      case 'OverconstrainedError':\n        errorMessage = 'Camera settings not supported';\n        errorAction = 'Trying with basic camera settings...';\n        canRetry = true;\n        break;\n      default:\n        errorMessage = error.message || 'Camera error';\n        errorAction = 'Please check your camera and try again';\n        canRetry = true;\n    }\n    setCameraError({\n      message: errorMessage,\n      action: errorAction,\n      canRetry\n    });\n    if (canRetry && cameraRetryCount < 2 && error.name !== 'NotAllowedError') {\n      const retryDelay = (cameraRetryCount + 1) * 2000;\n      console.log(`ðŸ”„ Auto-retrying camera setup in ${retryDelay / 1000}s (attempt ${cameraRetryCount + 1}/2)`);\n      setTimeout(() => {\n        setCameraRetryCount(prev => prev + 1);\n        setupCamera();\n      }, retryDelay);\n    }\n  };\n  const retryCameraSetup = () => {\n    console.log('ðŸ”„ Manual camera retry requested');\n    setCameraRetryCount(0);\n    setCameraError(null);\n    setCameraInitializationComplete(false);\n    initializationPromiseRef.current = null;\n    setupCamera();\n  };\n  const showCameraMessage = (message, type = 'info') => {\n    const messageDiv = document.createElement('div');\n    messageDiv.className = 'camera-toast-message';\n    messageDiv.innerHTML = message;\n    messageDiv.style.cssText = `\n            position: fixed;\n            top: 20px;\n            right: 20px;\n            background: ${type === 'success' ? '#28a745' : type === 'error' ? '#dc3545' : '#17a2b8'};\n            color: white;\n            padding: 12px 20px;\n            border-radius: 6px;\n            z-index: 10000;\n            font-weight: 500;\n            box-shadow: 0 4px 12px rgba(0,0,0,0.2);\n            max-width: 300px;\n        `;\n    document.body.appendChild(messageDiv);\n    setTimeout(() => {\n      if (messageDiv.parentNode) {\n        messageDiv.parentNode.removeChild(messageDiv);\n      }\n    }, 3000);\n  };\n\n  // ðŸ”¥ MODIFIED: Smart scanning with cooldown system\n  const startScanning = () => {\n    if (!visionServiceRef.current || cameraStatus !== 'ready') {\n      console.log('âš ï¸ MTG Scanner not ready');\n      if (cameraStatus === 'error') {\n        showCameraMessage('âŒ Camera not ready. Please fix camera issues first.', 'error');\n      }\n      return;\n    }\n    console.log(`â–¶ï¸ Starting MTG Scanner Pro with Smart Cooldown - ${scanMode} mode...`);\n    setIsScanning(true);\n    setScanningPausedForSelection(false);\n\n    // ðŸ”¥ Reset cooldowns when starting scanning\n    cooldownSystemRef.current.resetCooldowns();\n    setCooldownStatus(cooldownSystemRef.current.getCooldownStatus());\n    if (scanMode === 'continuous') {\n      setContinuousCount(0);\n      console.log('ðŸ”„ Continuous mode: Reset counter to 0');\n    }\n\n    // ðŸ”¥ MODIFIED: Smart scanning interval with cooldown logic\n    scanIntervalRef.current = setInterval(async () => {\n      try {\n        // ðŸ”¥ Check cooldown system first\n        const currentCardName = currentCard === null || currentCard === void 0 ? void 0 : currentCard.cardName;\n        if (!cooldownSystemRef.current.shouldScan(currentCardName)) {\n          // Update cooldown status for UI\n          setCooldownStatus(cooldownSystemRef.current.getCooldownStatus());\n          return; // Skip this frame due to cooldown\n        }\n\n        // Don't scan if edition selector is showing\n        if (scanningPausedForSelection || showEditionSelector) {\n          console.log('â¸ï¸ Scanning paused for edition selection');\n          cooldownSystemRef.current.setEditionSelectorOpen(true);\n          return;\n        } else {\n          cooldownSystemRef.current.setEditionSelectorOpen(false);\n        }\n\n        // ðŸ”¥ Frame change detection\n        const canvas = document.createElement('canvas');\n        const video = videoRef.current;\n        canvas.width = video.videoWidth;\n        canvas.height = video.videoHeight;\n        const ctx = canvas.getContext('2d');\n        ctx.drawImage(video, 0, 0);\n\n        // Get frame data for change detection\n        const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);\n\n        // ðŸ”¥ Check if frame has changed significantly\n        if (!cooldownSystemRef.current.hasFrameChanged(imageData.data)) {\n          console.log(\"ðŸ“· Frame unchanged, skipping scan\");\n          return;\n        }\n        console.log(\"ðŸ”„ Processing frame for MTG CARD IDENTIFICATION...\");\n\n        // Call the vision service\n        const result = await visionServiceRef.current.processVideoFrame(videoRef.current);\n        if (result && result.hasCard && result.confidence >= 70) {\n          console.log('ðŸŽ¯ MTG Card detected:', result.cardName, `(${result.confidence}%)`);\n\n          // ðŸ”¥ Record detection in cooldown system\n          cooldownSystemRef.current.recordDetection(result.cardName);\n          setCooldownStatus(cooldownSystemRef.current.getCooldownStatus());\n\n          // Stop scanning in single mode when card detected\n          if (scanMode === 'single') {\n            stopScanning();\n          }\n\n          // Always check for multiple editions\n          await handleCardDetection(result);\n        } else if (result && !result.hasCard) {\n          setScanResult({\n            hasCard: false,\n            message: result.message || 'No MTG card detected'\n          });\n          setCurrentCard(null);\n        }\n\n        // Update cooldown status\n        setCooldownStatus(cooldownSystemRef.current.getCooldownStatus());\n      } catch (error) {\n        console.error('âŒ Scanning error:', error);\n        setScanResult({\n          hasCard: false,\n          message: 'Scanner error - please try again'\n        });\n      }\n    }, scanMode === 'single' ? 500 : 1000);\n  };\n\n  // Handle card detection with cooldown integration\n  const handleCardDetection = async detectedCard => {\n    try {\n      console.log('ðŸŽ­ Checking for multiple editions of:', detectedCard.cardName);\n      const cardName = detectedCard.cardName.trim();\n      const searchQuery = `!\"${cardName}\"`;\n      const encodedQuery = encodeURIComponent(searchQuery);\n      console.log('ðŸ” Scryfall search query:', searchQuery);\n      const editionsResponse = await fetch(`https://api.scryfall.com/cards/search?q=${encodedQuery}&unique=prints&order=released&dir=desc`);\n      if (editionsResponse.ok) {\n        const editionsData = await editionsResponse.json();\n        const editions = editionsData.data || [];\n        console.log(`ðŸ“Š Scryfall returned ${editions.length} total results`);\n        const exactMatches = editions.filter(card => {\n          const cardNameNormalized = card.name.toLowerCase().trim();\n          const searchNameNormalized = cardName.toLowerCase().trim();\n          return cardNameNormalized === searchNameNormalized;\n        });\n        console.log(`ðŸŽ¯ Found ${exactMatches.length} exact name matches for \"${cardName}\"`);\n        exactMatches.forEach((card, index) => {\n          console.log(`   ${index + 1}. ${card.set_name} (${card.set.toUpperCase()}) - ${card.released_at}`);\n        });\n        if (exactMatches.length > 1) {\n          // ðŸ”¥ Notify cooldown system of edition selector opening\n          console.log(`ðŸŽ­ Multiple editions found - pausing scanner for selection`);\n          setScanningPausedForSelection(true);\n          cooldownSystemRef.current.setEditionSelectorOpen(true);\n          const sortedEditions = sortEditionsByPreference(cardName, exactMatches);\n          setPendingCardData(detectedCard);\n          setPendingScanMode(scanMode);\n          setAvailableEditions(sortedEditions);\n          setShowEditionSelector(true);\n          setScanResult(null);\n          setCurrentCard(null);\n          return;\n        } else if (exactMatches.length === 1) {\n          console.log(`âœ… Single edition found: ${exactMatches[0].set_name} (${exactMatches[0].set.toUpperCase()})`);\n          const enhancedCard = enhanceCardWithScryfall(detectedCard, exactMatches[0]);\n          displayCard(enhancedCard);\n          if (scanMode === 'continuous' && autoSaveEnabled) {\n            const saved = await saveCardToCollection(enhancedCard);\n            if (saved) {\n              console.log(`ðŸ’¾ AUTO-SAVED: ${enhancedCard.cardName} to collection`);\n              handleContinuousCounterAndLimit();\n            }\n          }\n        } else {\n          console.log('âš ï¸ No exact Scryfall matches found, using original detection');\n          displayCard(detectedCard);\n          if (scanMode === 'continuous' && autoSaveEnabled) {\n            const saved = await saveCardToCollection(detectedCard);\n            if (saved) {\n              console.log(`ðŸ’¾ AUTO-SAVED: ${detectedCard.cardName} to collection (no Scryfall match)`);\n              handleContinuousCounterAndLimit();\n            }\n          }\n        }\n      } else {\n        const errorText = await editionsResponse.text();\n        console.log('âŒ Scryfall API error:', editionsResponse.status, errorText);\n        displayCard(detectedCard);\n      }\n    } catch (error) {\n      console.error('âŒ Edition lookup error:', error);\n      displayCard(detectedCard);\n    }\n  };\n\n  // AI Learning - Sort editions by user preferences\n  const sortEditionsByPreference = (cardName, editions) => {\n    const cardKey = cardName.toLowerCase().trim();\n    const userPreference = editionPreferences[cardKey];\n    if (userPreference) {\n      console.log(`ðŸ§  AI Learning: User previously preferred ${userPreference} for ${cardName}`);\n      return editions.sort((a, b) => {\n        if (a.set === userPreference) return -1;\n        if (b.set === userPreference) return 1;\n        return 0;\n      });\n    }\n    return editions;\n  };\n  const learnEditionPreference = (cardName, selectedEdition) => {\n    const cardKey = cardName.toLowerCase().trim();\n    const newPreferences = {\n      ...editionPreferences,\n      [cardKey]: selectedEdition.set\n    };\n    setEditionPreferences(newPreferences);\n    localStorage.setItem('mtg_edition_preferences', JSON.stringify(newPreferences));\n    console.log(`ðŸ§  AI Learning: Remembered ${selectedEdition.set_name} preference for ${cardName}`);\n  };\n  const handleContinuousCounterAndLimit = () => {\n    const newCount = continuousCount + 1;\n    setContinuousCount(newCount);\n    if (newCount >= 10) {\n      console.log('ðŸ›‘ CONTINUOUS MODE: 10-card limit reached, pausing...');\n      stopScanning();\n      setShowContinueDialog(true);\n    }\n  };\n  const handleContinueScanning = () => {\n    console.log('ðŸ”„ User chose to continue scanning...');\n    setShowContinueDialog(false);\n    setContinuousCount(0);\n    // ðŸ”¥ Reset cooldowns when continuing\n    cooldownSystemRef.current.resetCooldowns();\n    startScanning();\n  };\n  const handleStopScanning = () => {\n    console.log('â¹ï¸ User chose to stop scanning at 10-card limit');\n    setShowContinueDialog(false);\n    setContinuousCount(0);\n  };\n  const enhanceCardWithScryfall = (originalCard, scryfallCard) => {\n    var _scryfallCard$image_u, _scryfallCard$image_u2;\n    return {\n      ...originalCard,\n      cardType: scryfallCard.type_line,\n      manaCost: scryfallCard.mana_cost,\n      setInfo: scryfallCard.set_name,\n      rarity: scryfallCard.rarity,\n      scryfallId: scryfallCard.id,\n      scryfallImageUrl: ((_scryfallCard$image_u = scryfallCard.image_uris) === null || _scryfallCard$image_u === void 0 ? void 0 : _scryfallCard$image_u.normal) || ((_scryfallCard$image_u2 = scryfallCard.image_uris) === null || _scryfallCard$image_u2 === void 0 ? void 0 : _scryfallCard$image_u2.large),\n      scryfallUri: scryfallCard.scryfall_uri,\n      prices: scryfallCard.prices,\n      collectorNumber: scryfallCard.collector_number,\n      releaseDate: scryfallCard.released_at,\n      scryfallVerified: true,\n      setCode: scryfallCard.set\n    };\n  };\n  const displayCard = card => {\n    setCurrentCard(card);\n    setScanResult(card);\n    setScanHistory(prev => {\n      const isDuplicate = prev.some(historyCard => historyCard.cardName === card.cardName && Math.abs(new Date(historyCard.timestamp) - new Date(card.timestamp)) < 5000);\n      if (!isDuplicate) {\n        return [card, ...prev.slice(0, 19)];\n      }\n      return prev;\n    });\n  };\n\n  // Handle edition selection with cooldown integration\n  const handleEditionSelected = async selectedEdition => {\n    if (pendingCardData && selectedEdition) {\n      const enhancedCard = enhanceCardWithScryfall(pendingCardData, selectedEdition);\n      displayCard(enhancedCard);\n      console.log(`âœ… User selected: ${selectedEdition.set_name} (${selectedEdition.set.toUpperCase()})`);\n      learnEditionPreference(pendingCardData.cardName, selectedEdition);\n      if (pendingScanMode === 'continuous' && autoSaveEnabled) {\n        const saved = await saveCardToCollection(enhancedCard);\n        if (saved) {\n          console.log(`ðŸ’¾ AUTO-SAVED: ${enhancedCard.cardName} to collection`);\n          handleContinuousCounterAndLimit();\n        }\n        if (continuousCount < 9) {\n          console.log('ðŸ”„ Resuming continuous scanning after edition selection...');\n          setTimeout(() => {\n            setScanningPausedForSelection(false);\n            // ðŸ”¥ Reset cooldowns after edition selection\n            cooldownSystemRef.current.setEditionSelectorOpen(false);\n            if (!isScanning) {\n              startScanning();\n            }\n          }, 1000);\n        }\n      }\n    }\n\n    // ðŸ”¥ Close edition selector and notify cooldown system\n    setShowEditionSelector(false);\n    setAvailableEditions([]);\n    setPendingCardData(null);\n    setPendingScanMode(null);\n    setScanningPausedForSelection(false);\n    cooldownSystemRef.current.setEditionSelectorOpen(false);\n    setCooldownStatus(cooldownSystemRef.current.getCooldownStatus());\n  };\n  const handleEditionCancelled = async () => {\n    if (pendingCardData) {\n      displayCard(pendingCardData);\n      if (pendingScanMode === 'continuous' && autoSaveEnabled) {\n        const saved = await saveCardToCollection(pendingCardData);\n        if (saved) {\n          console.log(`ðŸ’¾ AUTO-SAVED: ${pendingCardData.cardName} to collection (cancelled edition selection)`);\n          handleContinuousCounterAndLimit();\n        }\n        if (continuousCount < 9) {\n          console.log('ðŸ”„ Resuming continuous scanning after cancellation...');\n          setTimeout(() => {\n            setScanningPausedForSelection(false);\n            cooldownSystemRef.current.setEditionSelectorOpen(false);\n            if (!isScanning) {\n              startScanning();\n            }\n          }, 1000);\n        }\n      }\n    }\n\n    // ðŸ”¥ Close edition selector and notify cooldown system\n    setShowEditionSelector(false);\n    setAvailableEditions([]);\n    setPendingCardData(null);\n    setPendingScanMode(null);\n    setScanningPausedForSelection(false);\n    cooldownSystemRef.current.setEditionSelectorOpen(false);\n    setCooldownStatus(cooldownSystemRef.current.getCooldownStatus());\n  };\n\n  // Stop scanning but keep camera active\n  const stopScanning = () => {\n    console.log('â¹ï¸ Stopping MTG Scanner (camera stays active for persistence)...');\n    setIsScanning(false);\n    setScanningPausedForSelection(false);\n    if (scanIntervalRef.current) {\n      clearInterval(scanIntervalRef.current);\n      scanIntervalRef.current = null;\n    }\n    console.log('ðŸ“· Camera stream preserved for tab persistence');\n  };\n\n  // Only cleanup camera on component unmount\n  const cleanup = () => {\n    console.log('ðŸ§¹ Cleaning up MTG Scanner...');\n    stopScanning();\n    if (cameraStreamRef.current) {\n      console.log('ðŸ“· Stopping persistent camera stream...');\n      cameraStreamRef.current.getTracks().forEach(track => track.stop());\n      cameraStreamRef.current = null;\n      setCameraInitializationComplete(false);\n    }\n    if (videoRef.current && videoRef.current.srcObject) {\n      const tracks = videoRef.current.srcObject.getTracks();\n      tracks.forEach(track => track.stop());\n      videoRef.current.srcObject = null;\n    }\n    initializationPromiseRef.current = null;\n  };\n\n  // Collection management\n  const saveCardToCollection = async card => {\n    try {\n      if (!isPremiumUser && savedCards.length >= FREE_COLLECTION_LIMIT) {\n        console.log('ðŸš¨ Free collection limit reached');\n        setShowPaywallModal(true);\n        return false;\n      }\n      const cardWithId = {\n        ...card,\n        id: Date.now() + Math.random(),\n        addedAt: new Date().toISOString(),\n        scannedAt: new Date().toLocaleString()\n      };\n      const updatedCards = [cardWithId, ...savedCards];\n      setSavedCards(updatedCards);\n      localStorage.setItem('mtg_saved_cards', JSON.stringify(updatedCards));\n      console.log('ðŸ’¾ Card saved to collection:', card.cardName);\n      if (scanMode === 'single') {\n        setScanResult(prev => ({\n          ...prev,\n          savedToCollection: true,\n          message: `âœ… ${card.cardName} saved to collection!`\n        }));\n        setTimeout(() => {\n          setScanResult(prev => ({\n            ...prev,\n            savedToCollection: false,\n            message: undefined\n          }));\n        }, 3000);\n      }\n      return true;\n    } catch (error) {\n      console.error('âŒ Failed to save card:', error);\n      setScanResult(prev => ({\n        ...prev,\n        message: `âŒ Failed to save ${card.cardName}`\n      }));\n      return false;\n    }\n  };\n  const handleUpgradeToPremium = () => {\n    console.log('ðŸ’Ž Initiating PayPal payment for premium upgrade...');\n    const paypalLink = `https://www.paypal.com/paypalme/thediceyguy/9.99?country.x=US&locale.x=en_US`;\n    window.open(paypalLink, '_blank');\n    setTimeout(() => {\n      setIsPremiumUser(true);\n      localStorage.setItem('mtg_premium_status', 'true');\n      setShowPaywallModal(false);\n      showCameraMessage('ðŸ’Ž Premium upgrade successful! Unlimited collection storage activated.', 'success');\n    }, 5000);\n  };\n  const removeCardFromCollection = cardId => {\n    try {\n      const updatedCards = savedCards.filter(card => card.id !== cardId);\n      setSavedCards(updatedCards);\n      localStorage.setItem('mtg_saved_cards', JSON.stringify(updatedCards));\n      console.log('ðŸ—‘ï¸ Card removed from collection');\n    } catch (error) {\n      console.error('âŒ Failed to remove card:', error);\n    }\n  };\n  const openCardInScryfall = card => {\n    if (card && card.cardName) {\n      const searchUrl = `https://scryfall.com/search?q=${encodeURIComponent(card.cardName)}`;\n      window.open(searchUrl, '_blank');\n      console.log('ðŸ”— Opening Scryfall for:', card.cardName);\n    }\n  };\n  const toggleUIVisibility = () => {\n    setIsUIVisible(!isUIVisible);\n    console.log('ðŸ‘ï¸ UI visibility toggled:', !isUIVisible);\n  };\n\n  // Tab switching handler that preserves camera\n  const handleTabSwitch = newTab => {\n    console.log(`ðŸ”„ Switching from ${activeTab} to ${newTab} (camera preserved)`);\n    setActiveTab(newTab);\n    if (newTab === 'scanner' && cameraStreamRef.current && videoRef.current) {\n      setTimeout(() => {\n        if (!videoRef.current.srcObject) {\n          console.log('ðŸ“· Reconnecting video element to persistent camera stream...');\n          videoRef.current.srcObject = cameraStreamRef.current;\n          videoRef.current.play();\n        }\n      }, 100);\n    }\n  };\n  const getCameraStatusDisplay = () => {\n    switch (cameraStatus) {\n      case 'initializing':\n        return {\n          text: 'ðŸ”§ Initializing...',\n          class: 'status-initializing'\n        };\n      case 'requesting':\n        return {\n          text: 'ðŸ“· Requesting access...',\n          class: 'status-requesting'\n        };\n      case 'ready':\n        return {\n          text: 'âœ… HD Camera Ready + Smart Cooldown',\n          class: 'status-ready'\n        };\n      case 'error':\n        return {\n          text: 'âŒ Camera Error',\n          class: 'status-error'\n        };\n      default:\n        return {\n          text: 'â³ Setting up...',\n          class: 'status-default'\n        };\n    }\n  };\n\n  // ðŸ”¥ NEW: Render cooldown status UI\n  const renderCooldownStatus = () => {\n    if (!cooldownStatus || activeTab !== 'scanner') return null;\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        position: 'absolute',\n        top: '10px',\n        right: '10px',\n        background: 'rgba(0,0,0,0.8)',\n        color: 'white',\n        padding: '12px',\n        borderRadius: '8px',\n        fontSize: '11px',\n        fontFamily: 'monospace',\n        border: '1px solid #4a90e2',\n        minWidth: '200px',\n        zIndex: 1000\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          color: '#4a90e2',\n          fontWeight: 'bold',\n          marginBottom: '6px'\n        },\n        children: \"\\uD83D\\uDD25 Smart Cooldown System\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 961,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [\"API Cooldown: \", Math.ceil(cooldownStatus.apiCooldown / 1000), \"s\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 964,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [\"Same Card: \", Math.ceil(cooldownStatus.sameCardCooldown / 1000), \"s\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 965,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [\"Consecutive: \", cooldownStatus.consecutiveDetections, \"/3\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 966,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [\"Edition Selector: \", cooldownStatus.isEditionSelectorOpen ? 'ðŸŽ­ Open' : 'âœ… Closed']\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 967,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          marginTop: '6px',\n          padding: '4px',\n          background: cooldownStatus.canScan ? 'rgba(40, 167, 69, 0.3)' : 'rgba(220, 53, 69, 0.3)',\n          borderRadius: '4px',\n          textAlign: 'center',\n          fontWeight: 'bold'\n        },\n        children: cooldownStatus.canScan ? 'âœ… Can Scan' : 'âŒ Cooldown Active'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 968,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 947,\n      columnNumber: 13\n    }, this);\n  };\n  const cameraStatus_display = getCameraStatusDisplay();\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"mtg-scanner-pro\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"app-header\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"app-title-section\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"app-logo\",\n          children: /*#__PURE__*/_jsxDEV(\"img\", {\n            src: \"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgdmlld0JveD0iMCAwIDEwMCAxMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHg9IjUiIHk9IjUiIHdpZHRoPSI5MCIgaGVpZ2h0PSI5MCIgcng9IjEwIiBzdHJva2U9IndoaXRlIiBzdHJva2Utd2lkdGg9IjMiIGZpbGw9IiMyMzI3MkEiLz4KPHRleHQgeD0iNTAiIHk9IjM1IiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmaWxsPSJ3aGl0ZSIgZm9udC1mYW1pbHk9IkFyaWFsLCBzYW5zLXNlcmlmIiBmb250LXNpemU9IjE4IiBmb250LXdlaWdodD0iYm9sZCI+TVRHPC90ZXh0Pgo8bGluZSB4MT0iMTUiIHkxPSI1MCIgeDI9Ijg1IiB5Mj0iNTAiIHN0cm9rZT0iIzRBOTBFMiIgc3Ryb2tlLXdpZHRoPSIzIi8+Cjx0ZXh0IHg9IjUwIiB5PSI3NSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZmlsbD0id2hpdGUiIGZvbnQtZmFtaWx5PSJBcmlhbCwgc2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgZm9udC13ZWlnaHQ9ImJvbGQiPlNDQU5ORVI8L3RleHQ+Cjwvc3ZnPgo=\",\n            alt: \"MTG Scanner Logo\",\n            className: \"logo-image\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 990,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 989,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"app-title\",\n          children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n            children: \"MTG Scanner Pro\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 997,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"app-subtitle\",\n            children: [\"\\uD83D\\uDD25 Smart Cooldown System \\u2022 \", isPremiumUser ? 'ðŸ’Ž Premium' : `${FREE_COLLECTION_LIMIT - savedCards.length} cards left`]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 998,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 996,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 988,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"header-stats\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"stat-item\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"stat-label\",\n            children: \"Accuracy:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1006,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"stat-value\",\n            children: \"98%\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1007,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1005,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"stat-item\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"stat-label\",\n            children: \"AI Learned:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1010,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"stat-value\",\n            children: Object.keys(editionPreferences).length\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1011,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1009,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"stat-item\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"stat-label\",\n            children: \"Cooldowns:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1014,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"stat-value\",\n            children: cooldownStatus.canScan ? 'âœ…' : 'â¸ï¸'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1015,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1013,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"stat-item\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"stat-label\",\n            children: \"Saved:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1018,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"stat-value\",\n            children: [savedCards.length, !isPremiumUser && `/${FREE_COLLECTION_LIMIT}`]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1019,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1017,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1004,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 987,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"tab-navigation\",\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        className: `tab-btn ${activeTab === 'scanner' ? 'active' : ''}`,\n        onClick: () => handleTabSwitch('scanner'),\n        children: [\"\\uD83D\\uDD0D Scanner \", scanningPausedForSelection && 'â¸ï¸', \" \", cooldownStatus.canScan ? 'ðŸ”¥' : 'â³']\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1028,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: `tab-btn ${activeTab === 'deck' ? 'active' : ''}`,\n        onClick: () => handleTabSwitch('deck'),\n        children: [\"\\uD83C\\uDCCF Collection (\", savedCards.length, !isPremiumUser && `/${FREE_COLLECTION_LIMIT}`, \")\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1034,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: `tab-btn ${activeTab === 'knowledge' ? 'active' : ''}`,\n        onClick: () => handleTabSwitch('knowledge'),\n        children: \"\\uD83D\\uDCDA MTG Knowledge\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1040,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 1027,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"main-content\",\n      children: [activeTab === 'scanner' && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"scanner-tab\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"scanner-section\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"video-container\",\n            children: [/*#__PURE__*/_jsxDEV(\"video\", {\n              ref: videoRef,\n              className: \"scanner-video\",\n              autoPlay: true,\n              playsInline: true,\n              muted: true\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1057,\n              columnNumber: 33\n            }, this), renderCooldownStatus(), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"camera-status-overlay\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: `status-indicator ${cameraStatus_display.class}`,\n                children: [cameraStatus_display.text, cameraInitializationComplete && ' ðŸ”„ Persistent Mode']\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1070,\n                columnNumber: 37\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1069,\n              columnNumber: 33\n            }, this), cameraError && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"camera-error-overlay\",\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"camera-error-card\",\n                children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n                  children: \"\\uD83D\\uDCF9 Camera Issue\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1080,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  children: /*#__PURE__*/_jsxDEV(\"strong\", {\n                    children: cameraError.message\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 1081,\n                    columnNumber: 48\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1081,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  children: cameraError.action\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1082,\n                  columnNumber: 45\n                }, this), cameraError.canRetry && /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: retryCameraSetup,\n                  className: \"retry-camera-btn\",\n                  children: \"\\uD83D\\uDD04 Try Again\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1084,\n                  columnNumber: 49\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1079,\n                columnNumber: 41\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1078,\n              columnNumber: 37\n            }, this), isScanning && !scanningPausedForSelection && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"scanning-overlay\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"scan-frame\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1098,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"scan-instructions\",\n                children: [\"\\uD83D\\uDD0D Position MTG card in frame\", /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"scan-tech\",\n                  children: scanMode === 'continuous' ? `ðŸ”¥ Smart cooldown mode (${continuousCount}/10)` : 'ðŸ“· Single shot with smart cooldown'\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1101,\n                  columnNumber: 45\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1099,\n                columnNumber: 41\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1097,\n              columnNumber: 37\n            }, this), scanningPausedForSelection && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"scanning-overlay\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"scan-frame\",\n                style: {\n                  borderColor: '#ffa500'\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1114,\n                columnNumber: 41\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"scan-instructions\",\n                children: [\"\\u23F8\\uFE0F Scanner paused for edition selection\", /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"scan-tech\",\n                  children: \"\\uD83C\\uDFAD Choose the correct edition below\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1117,\n                  columnNumber: 45\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1115,\n                columnNumber: 41\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1113,\n              columnNumber: 37\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1056,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"scanner-controls\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"scan-mode-section\",\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                className: \"scan-mode-label\",\n                children: \"Scan Mode:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1129,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"scan-mode-toggle\",\n                children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                  className: `mode-btn ${scanMode === 'continuous' ? 'active' : ''}`,\n                  onClick: () => setScanMode('continuous'),\n                  disabled: isScanning || showEditionSelector,\n                  children: [\"\\uD83D\\uDD25 Smart Continuous \", scanMode === 'continuous' && `(${continuousCount}/10)`]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1131,\n                  columnNumber: 41\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  className: `mode-btn ${scanMode === 'single' ? 'active' : ''}`,\n                  onClick: () => setScanMode('single'),\n                  disabled: isScanning || showEditionSelector,\n                  children: \"\\uD83D\\uDCF7 Smart Single Shot\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 1138,\n                  columnNumber: 41\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 1130,\n                columnNumber: 37\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1128,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: `scan-btn ${isScanning ? 'scanning' : 'ready'}`,\n              onClick: isScanning ? stopScanning : startScanning,\n              disabled: cameraStatus !== 'ready' || showEditionSelector,\n              children: showEditionSelector ? 'ðŸŽ­ Choose Edition Below' : scanningPausedForSelection ? 'â¸ï¸ Paused for Selection' : isScanning ? 'â¹ï¸ Stop Smart Scanning' : `ðŸ”¥ Start Smart ${scanMode === 'single' ? 'Single' : 'Continuous'} Scan`\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1149,\n              columnNumber: 33\n            }, this), cameraStatus === 'error' && /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"retry-camera-btn\",\n              onClick: retryCameraSetup,\n              title: \"Retry camera initialization\",\n              children: \"\\uD83D\\uDD04 Fix Camera\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1162,\n              columnNumber: 37\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"ui-toggle-btn\",\n              onClick: toggleUIVisibility,\n              title: \"Toggle card information display\",\n              children: isUIVisible ? 'ðŸ‘ï¸ Hide Info' : 'ðŸ‘ï¸ Show Info'\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1171,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"debug-btn\",\n              onClick: () => {\n                cooldownSystemRef.current.resetCooldowns();\n                setCooldownStatus(cooldownSystemRef.current.getCooldownStatus());\n                console.log('ðŸ”„ Cooldowns manually reset');\n                showCameraMessage('ðŸ”„ Cooldowns reset!', 'success');\n              },\n              title: \"Reset all cooldowns\",\n              style: {\n                background: '#28a745',\n                color: 'white',\n                border: 'none',\n                padding: '8px 16px',\n                borderRadius: '4px',\n                cursor: 'pointer',\n                fontSize: '12px'\n              },\n              children: \"\\uD83D\\uDD04 Reset Cooldowns\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 1180,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1126,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1054,\n          columnNumber: 25\n        }, this), isUIVisible && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"card-info-section\",\n          children: /*#__PURE__*/_jsxDEV(CardDisplayUI, {\n            scanResult: scanResult,\n            isScanning: isScanning,\n            onSaveCard: saveCardToCollection,\n            onOpenScryfall: openCardInScryfall,\n            scanHistory: scanHistory\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1207,\n            columnNumber: 33\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1206,\n          columnNumber: 29\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1053,\n        columnNumber: 21\n      }, this), activeTab === 'deck' && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"deck-tab\",\n        children: /*#__PURE__*/_jsxDEV(DeckManager, {\n          savedCards: savedCards,\n          onRemoveCard: removeCardFromCollection,\n          onOpenScryfall: openCardInScryfall,\n          scanHistory: scanHistory,\n          isPremiumUser: isPremiumUser,\n          collectionLimit: FREE_COLLECTION_LIMIT,\n          onUpgrade: handleUpgradeToPremium\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1222,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1221,\n        columnNumber: 21\n      }, this), activeTab === 'knowledge' && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"knowledge-tab\",\n        children: /*#__PURE__*/_jsxDEV(MTGKnowledgeBase, {\n          currentCard: currentCard,\n          savedCards: savedCards,\n          editionPreferences: editionPreferences\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1237,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1236,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 1049,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"status-bar\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"status-left\",\n        children: scanHistory.length > 0 && /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"status-item\",\n            children: [\"\\uD83D\\uDCCA Scanned: \", scanHistory.length]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1251,\n            columnNumber: 29\n          }, this), currentCard && /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"status-item\",\n            children: [\"\\uD83C\\uDFAF Last: \", currentCard.cardName, \" (\", currentCard.confidence, \"%)\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1253,\n            columnNumber: 33\n          }, this)]\n        }, void 0, true)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 1248,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"status-right\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"footer-logo\",\n          children: [/*#__PURE__*/_jsxDEV(\"img\", {\n            src: \"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgdmlld0JveD0iMCAwIDEwMCAxMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHg9IjUiIHk9IjUiIHdpZHRoPSI5MCIgaGVpZ2h0PSI5MCIgcng9IjEwIiBzdHJva2U9IndoaXRlIiBzdHJva2Utd2lkdGg9IjMiIGZpbGw9IiMyMzI3MkEiLz4KPHRleHQgeD0iNTAiIHk9IjM1IiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmaWxsPSJ3aGl0ZSIgZm9udC1mYW1pbHk9IkFyaWFsLCBzYW5zLXNlcmlmIiBmb250LXNpemU9IjE4IiBmb250LXdlaWdodD0iYm9sZCI+TVRHPC90ZXh0Pgo8bGluZSB4MT0iMTUiIHkxPSI1MCIgeDI9Ijg1IiB5Mj0iNTAiIHN0cm9rZT0iIzRBOTBFMiIgc3Ryb2tlLXdpZHRoPSIzIi8+Cjx0ZXh0IHg9IjUwIiB5PSI3NSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZmlsbD0id2hpdGUiIGZvbnQtZmFtaWx5PSJBcmlhbCwgc2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgZm9udC13ZWlnaHQ9ImJvbGQiPlNDQU5ORVI8L3RleHQ+Cjwvc3ZnPgo=\",\n            alt: \"MTG Scanner\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1262,\n            columnNumber: 25\n          }, this), \"MTG Scanner\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1261,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"status-item\",\n          children: [\"\\uD83D\\uDD25 Smart Cooldown: \", cooldownStatus.canScan ? 'Ready' : 'Active']\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1268,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"status-item\",\n          children: [\"\\uD83D\\uDCF7 Camera: \", cameraInitializationComplete ? 'Persistent âœ…' : 'Initializing â³']\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1269,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"status-item\",\n          children: [\"\\uD83E\\uDDE0 AI Learning: \", Object.keys(editionPreferences).length, \" cards\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1272,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"status-item\",\n          children: \"\\uD83D\\uDCE1 Scryfall Database\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1273,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"status-item\",\n          children: isPremiumUser ? 'ðŸ’Ž Premium' : 'ðŸ†“ Free'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1274,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1260,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 1247,\n      columnNumber: 13\n    }, this), showEditionSelector && /*#__PURE__*/_jsxDEV(EditionSelector, {\n      cardName: pendingCardData === null || pendingCardData === void 0 ? void 0 : pendingCardData.cardName,\n      availableEditions: availableEditions,\n      onEditionSelected: handleEditionSelected,\n      onCancel: handleEditionCancelled,\n      aiRecommendation: editionPreferences[pendingCardData === null || pendingCardData === void 0 ? void 0 : (_pendingCardData$card = pendingCardData.cardName) === null || _pendingCardData$card === void 0 ? void 0 : (_pendingCardData$card2 = _pendingCardData$card.toLowerCase()) === null || _pendingCardData$card2 === void 0 ? void 0 : _pendingCardData$card2.trim()]\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 1280,\n      columnNumber: 17\n    }, this), showPaywallModal && /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        position: 'fixed',\n        top: 0,\n        left: 0,\n        width: '100%',\n        height: '100%',\n        background: 'rgba(0,0,0,0.9)',\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n        zIndex: 10001\n      },\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          background: 'linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f1419 100%)',\n          border: '2px solid #4a90e2',\n          borderRadius: '15px',\n          padding: '30px',\n          maxWidth: '500px',\n          textAlign: 'center',\n          color: 'white',\n          boxShadow: '0 20px 60px rgba(0,0,0,0.8)'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          style: {\n            margin: '0 0 20px 0',\n            color: '#4a90e2',\n            fontSize: '24px'\n          },\n          children: \"\\uD83D\\uDC8E Upgrade to Premium\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1313,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            margin: '20px 0',\n            fontSize: '18px'\n          },\n          children: /*#__PURE__*/_jsxDEV(\"p\", {\n            style: {\n              margin: '8px 0',\n              lineHeight: '1.5'\n            },\n            children: [\"You've reached the \", /*#__PURE__*/_jsxDEV(\"strong\", {\n              children: [FREE_COLLECTION_LIMIT, \" card limit\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1319,\n              columnNumber: 52\n            }, this), \" for free users!\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1318,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1317,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            background: 'rgba(74, 144, 226, 0.1)',\n            padding: '20px',\n            borderRadius: '10px',\n            margin: '20px 0'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            style: {\n              margin: '0 0 15px 0',\n              color: '#4a90e2'\n            },\n            children: \"Premium Features:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1329,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n            style: {\n              textAlign: 'left',\n              lineHeight: '1.8',\n              margin: 0,\n              paddingLeft: '20px'\n            },\n            children: [/*#__PURE__*/_jsxDEV(\"li\", {\n              children: [\"\\uD83D\\uDD25 \", /*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"Unlimited collection storage\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1331,\n                columnNumber: 40\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1331,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n              children: [\"\\uD83E\\uDDE0 \", /*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"Advanced AI learning\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1332,\n                columnNumber: 40\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1332,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n              children: [\"\\uD83D\\uDCCA \", /*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"Collection analytics\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1333,\n                columnNumber: 40\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1333,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n              children: [\"\\uD83D\\uDCB0 \", /*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"Price tracking & alerts\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1334,\n                columnNumber: 40\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1334,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n              children: [\"\\uD83C\\uDFAF \", /*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"Deck optimization tools\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1335,\n                columnNumber: 40\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1335,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n              children: [\"\\u26A1 \", /*#__PURE__*/_jsxDEV(\"strong\", {\n                children: \"Priority customer support\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 1336,\n                columnNumber: 39\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 1336,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1330,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1323,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            display: 'flex',\n            gap: '15px',\n            margin: '25px 0',\n            justifyContent: 'center'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: handleUpgradeToPremium,\n            style: {\n              padding: '15px 30px',\n              border: 'none',\n              borderRadius: '8px',\n              fontWeight: '600',\n              cursor: 'pointer',\n              fontSize: '16px',\n              background: 'linear-gradient(45deg, #4a90e2, #357abd)',\n              color: 'white',\n              boxShadow: '0 4px 15px rgba(74, 144, 226, 0.4)'\n            },\n            children: \"\\uD83D\\uDC8E Upgrade for $9.99/month\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1346,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setShowPaywallModal(false),\n            style: {\n              padding: '15px 20px',\n              border: '1px solid #666',\n              borderRadius: '8px',\n              fontWeight: '600',\n              cursor: 'pointer',\n              fontSize: '16px',\n              background: 'transparent',\n              color: 'white'\n            },\n            children: \"Maybe Later\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1362,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1340,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            marginTop: '20px',\n            paddingTop: '20px',\n            borderTop: '1px solid #444',\n            fontSize: '12px',\n            color: '#ccc'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"\\uD83D\\uDCB3 Secure payment via PayPal\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1386,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"\\uD83D\\uDCE7 Payment to: thediceyguy@gmail.com\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1387,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"\\uD83D\\uDD12 Cancel anytime, no long-term commitment\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1388,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1379,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1303,\n        columnNumber: 21\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 1291,\n      columnNumber: 17\n    }, this), showContinueDialog && /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        position: 'fixed',\n        top: 0,\n        left: 0,\n        width: '100%',\n        height: '100%',\n        background: 'rgba(0,0,0,0.8)',\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n        zIndex: 10000\n      },\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          background: '#23272a',\n          border: '2px solid #4a90e2',\n          borderRadius: '12px',\n          padding: '24px',\n          maxWidth: '450px',\n          textAlign: 'center',\n          color: 'white',\n          boxShadow: '0 8px 32px rgba(0,0,0,0.5)'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          style: {\n            margin: '0 0 16px 0',\n            color: '#4a90e2',\n            fontSize: '20px'\n          },\n          children: \"\\uD83D\\uDD25 10 Cards Scanned with Smart Cooldown!\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 1418,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          style: {\n            margin: '8px 0',\n            lineHeight: '1.5'\n          },\n          children: [\"You've successfully scanned \", /*#__PURE__*/_jsxDEV(\"strong\", {\n            children: \"10 cards\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1422,\n            columnNumber: 57\n          }, this), \" with the smart cooldown system.\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1421,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          style: {\n            margin: '8px 0',\n            lineHeight: '1.5'\n          },\n          children: [\"AI learned \", /*#__PURE__*/_jsxDEV(\"strong\", {\n            children: Object.keys(editionPreferences).length\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1425,\n            columnNumber: 40\n          }, this), \" edition preferences.\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1424,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          style: {\n            margin: '8px 0',\n            lineHeight: '1.5'\n          },\n          children: [\"Total saved to collection: \", /*#__PURE__*/_jsxDEV(\"strong\", {\n            children: savedCards.length\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1428,\n            columnNumber: 56\n          }, this), \" cards\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1427,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            display: 'flex',\n            gap: '12px',\n            margin: '20px 0',\n            justifyContent: 'center'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: handleContinueScanning,\n            style: {\n              padding: '12px 20px',\n              border: 'none',\n              borderRadius: '6px',\n              fontWeight: '600',\n              cursor: 'pointer',\n              fontSize: '14px',\n              background: '#4a90e2',\n              color: 'white'\n            },\n            children: \"\\uD83D\\uDD25 Continue Smart Scanning\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1437,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: handleStopScanning,\n            style: {\n              padding: '12px 20px',\n              border: 'none',\n              borderRadius: '6px',\n              fontWeight: '600',\n              cursor: 'pointer',\n              fontSize: '14px',\n              background: '#666',\n              color: 'white'\n            },\n            children: \"\\u23F9\\uFE0F Stop & Review Collection\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 1452,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1431,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            display: 'flex',\n            justifyContent: 'space-around',\n            marginTop: '16px',\n            paddingTop: '16px',\n            borderTop: '1px solid #444',\n            fontSize: '12px',\n            color: '#ccc'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            children: [\"\\uD83D\\uDD25 Smart scans: \", continuousCount]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1478,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            children: [\"\\uD83E\\uDDE0 AI learned: \", Object.keys(editionPreferences).length]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1479,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            children: [\"\\uD83D\\uDCC1 Collection: \", savedCards.length, \" total\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 1480,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 1469,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 1408,\n        columnNumber: 21\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 1396,\n      columnNumber: 17\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 985,\n    columnNumber: 9\n  }, this);\n};\n_s(Scanner, \"CYTHnypi6y+7K51Wlz8orruzd3c=\");\n_c = Scanner;\nexport default Scanner;\nvar _c;\n$RefreshReg$(_c, \"Scanner\");","map":{"version":3,"names":["React","useState","useRef","useEffect","ClaudeVisionService","CardDisplayUI","DeckManager","MTGKnowledgeBase","EditionSelector","jsxDEV","_jsxDEV","Fragment","_Fragment","MTGScannerCooldown","constructor","lastDetectedCard","lastDetectionTime","lastApiCall","consecutiveDetections","isEditionSelectorOpen","SAME_CARD_COOLDOWN","MIN_API_INTERVAL","FRAME_CHANGE_THRESHOLD","MAX_CONSECUTIVE","lastFrameData","shouldScan","cardName","now","Date","console","log","timeSinceLastDetection","hasFrameChanged","currentFrameData","changeRatio","calculateFrameChange","hasChanged","frame1","frame2","length","differences","sampleSize","Math","min","i","abs","recordDetection","resetCooldowns","setEditionSelectorOpen","isOpen","getCooldownStatus","sameCardCooldown","max","apiCooldown","canScan","Scanner","_s","_pendingCardData$card","_pendingCardData$card2","isScanning","setIsScanning","scanResult","setScanResult","cameraStatus","setCameraStatus","currentCard","setCurrentCard","scanMode","setScanMode","continuousCount","setContinuousCount","showContinueDialog","setShowContinueDialog","autoSaveEnabled","setAutoSaveEnabled","cooldownStatus","setCooldownStatus","activeTab","setActiveTab","scanHistory","setScanHistory","isUIVisible","setIsUIVisible","savedCards","setSavedCards","showEditionSelector","setShowEditionSelector","availableEditions","setAvailableEditions","pendingCardData","setPendingCardData","pendingScanMode","setPendingScanMode","scanningPausedForSelection","setScanningPausedForSelection","editionPreferences","setEditionPreferences","isPremiumUser","setIsPremiumUser","showPaywallModal","setShowPaywallModal","FREE_COLLECTION_LIMIT","cameraError","setCameraError","cameraRetryCount","setCameraRetryCount","cameraInitializationComplete","setCameraInitializationComplete","videoRef","scanIntervalRef","visionServiceRef","cameraStreamRef","initializationPromiseRef","cooldownSystemRef","initializeServices","loadSavedData","current","setupCamera","cooldownUpdateInterval","setInterval","clearInterval","cleanup","active","srcObject","play","stopScanning","error","saved","localStorage","getItem","JSON","parse","preferences","premiumStatus","navigator","mediaDevices","getUserMedia","Error","stream","logitechConstraints","video","deviceId","exact","width","ideal","height","frameRate","audio","logitechError","generalConstraints","facingMode","onloadedmetadata","videoWidth","videoHeight","showCameraMessage","handleCameraError","errorMessage","errorAction","canRetry","name","message","action","retryDelay","setTimeout","prev","retryCameraSetup","type","messageDiv","document","createElement","className","innerHTML","style","cssText","body","appendChild","parentNode","removeChild","startScanning","currentCardName","canvas","ctx","getContext","drawImage","imageData","getImageData","data","result","processVideoFrame","hasCard","confidence","handleCardDetection","detectedCard","trim","searchQuery","encodedQuery","encodeURIComponent","editionsResponse","fetch","ok","editionsData","json","editions","exactMatches","filter","card","cardNameNormalized","toLowerCase","searchNameNormalized","forEach","index","set_name","set","toUpperCase","released_at","sortedEditions","sortEditionsByPreference","enhancedCard","enhanceCardWithScryfall","displayCard","saveCardToCollection","handleContinuousCounterAndLimit","errorText","text","status","cardKey","userPreference","sort","a","b","learnEditionPreference","selectedEdition","newPreferences","setItem","stringify","newCount","handleContinueScanning","handleStopScanning","originalCard","scryfallCard","_scryfallCard$image_u","_scryfallCard$image_u2","cardType","type_line","manaCost","mana_cost","setInfo","rarity","scryfallId","id","scryfallImageUrl","image_uris","normal","large","scryfallUri","scryfall_uri","prices","collectorNumber","collector_number","releaseDate","scryfallVerified","setCode","isDuplicate","some","historyCard","timestamp","slice","handleEditionSelected","handleEditionCancelled","getTracks","track","stop","tracks","cardWithId","random","addedAt","toISOString","scannedAt","toLocaleString","updatedCards","savedToCollection","undefined","handleUpgradeToPremium","paypalLink","window","open","removeCardFromCollection","cardId","openCardInScryfall","searchUrl","toggleUIVisibility","handleTabSwitch","newTab","getCameraStatusDisplay","class","renderCooldownStatus","position","top","right","background","color","padding","borderRadius","fontSize","fontFamily","border","minWidth","zIndex","children","fontWeight","marginBottom","fileName","_jsxFileName","lineNumber","columnNumber","ceil","marginTop","textAlign","cameraStatus_display","src","alt","Object","keys","onClick","ref","autoPlay","playsInline","muted","borderColor","disabled","title","cursor","onSaveCard","onOpenScryfall","onRemoveCard","collectionLimit","onUpgrade","onEditionSelected","onCancel","aiRecommendation","left","display","alignItems","justifyContent","maxWidth","boxShadow","margin","lineHeight","paddingLeft","gap","paddingTop","borderTop","_c","$RefreshReg$"],"sources":["C:/Users/kim-a/Documents/DiceyTeck/MTG Scanner BACKUP/src/Scanner.js"],"sourcesContent":["// Scanner.js - MTG Scanner with Smart Cooldown System - COMPLETE INTEGRATED VERSION\r\nimport React, { useState, useRef, useEffect } from 'react';\r\nimport ClaudeVisionService from './ClaudeVisionService';\r\nimport CardDisplayUI from './CardDisplayUI';\r\nimport DeckManager from './DeckManager';\r\nimport MTGKnowledgeBase from './MTGKnowledgeBase';\r\nimport EditionSelector from './EditionSelector';\r\nimport './CardDisplay.css';\r\n\r\n// ðŸ”¥ Smart Cooldown System Class\r\nclass MTGScannerCooldown {\r\n    constructor() {\r\n        this.lastDetectedCard = null;\r\n        this.lastDetectionTime = 0;\r\n        this.lastApiCall = 0;\r\n        this.consecutiveDetections = 0;\r\n        this.isEditionSelectorOpen = false;\r\n        \r\n        // Cooldown periods (in milliseconds)\r\n        this.SAME_CARD_COOLDOWN = 8000;      // 8 seconds for same card\r\n        this.MIN_API_INTERVAL = 2000;        // 2 seconds between API calls\r\n        this.FRAME_CHANGE_THRESHOLD = 0.1;   // 10% frame change required\r\n        this.MAX_CONSECUTIVE = 3;            // Max detections before longer cooldown\r\n        \r\n        this.lastFrameData = null;\r\n    }\r\n\r\n    // Check if we should scan this frame\r\n    shouldScan(cardName = null) {\r\n        const now = Date.now();\r\n        \r\n        // 1. Don't scan if edition selector is open\r\n        if (this.isEditionSelectorOpen) {\r\n            console.log(\"ðŸš« Scanning blocked: Edition selector open\");\r\n            return false;\r\n        }\r\n        \r\n        // 2. Enforce minimum API interval\r\n        if (now - this.lastApiCall < this.MIN_API_INTERVAL) {\r\n            console.log(`ðŸš« Scanning blocked: API cooldown (${this.MIN_API_INTERVAL - (now - this.lastApiCall)}ms remaining)`);\r\n            return false;\r\n        }\r\n        \r\n        // 3. Same card cooldown\r\n        if (cardName && cardName === this.lastDetectedCard) {\r\n            const timeSinceLastDetection = now - this.lastDetectionTime;\r\n            if (timeSinceLastDetection < this.SAME_CARD_COOLDOWN) {\r\n                console.log(`ðŸš« Scanning blocked: Same card cooldown for \"${cardName}\" (${this.SAME_CARD_COOLDOWN - timeSinceLastDetection}ms remaining)`);\r\n                return false;\r\n            }\r\n        }\r\n        \r\n        // 4. Consecutive detection limit\r\n        if (this.consecutiveDetections >= this.MAX_CONSECUTIVE) {\r\n            console.log(`ðŸš« Scanning blocked: Max consecutive detections reached (${this.MAX_CONSECUTIVE})`);\r\n            return false;\r\n        }\r\n        \r\n        return true;\r\n    }\r\n\r\n    // Check if frame has changed significantly\r\n    hasFrameChanged(currentFrameData) {\r\n        if (!this.lastFrameData) {\r\n            this.lastFrameData = currentFrameData;\r\n            return true;\r\n        }\r\n        \r\n        // Simple frame change detection\r\n        const changeRatio = this.calculateFrameChange(this.lastFrameData, currentFrameData);\r\n        const hasChanged = changeRatio > this.FRAME_CHANGE_THRESHOLD;\r\n        \r\n        if (hasChanged) {\r\n            this.lastFrameData = currentFrameData;\r\n        }\r\n        \r\n        return hasChanged;\r\n    }\r\n\r\n    // Simple frame change calculation\r\n    calculateFrameChange(frame1, frame2) {\r\n        if (frame1.length !== frame2.length) return 1;\r\n        \r\n        let differences = 0;\r\n        const sampleSize = Math.min(1000, frame1.length); // Sample for performance\r\n        \r\n        for (let i = 0; i < sampleSize; i += 4) { // Sample every 4th byte\r\n            if (Math.abs(frame1[i] - frame2[i]) > 10) { // Threshold for significant change\r\n                differences++;\r\n            }\r\n        }\r\n        \r\n        return differences / (sampleSize / 4);\r\n    }\r\n\r\n    // Record a detection\r\n    recordDetection(cardName) {\r\n        const now = Date.now();\r\n        \r\n        if (cardName === this.lastDetectedCard) {\r\n            this.consecutiveDetections++;\r\n        } else {\r\n            this.consecutiveDetections = 1;\r\n            this.lastDetectedCard = cardName;\r\n        }\r\n        \r\n        this.lastDetectionTime = now;\r\n        this.lastApiCall = now;\r\n        \r\n        console.log(`âœ… Detection recorded: \"${cardName}\" (consecutive: ${this.consecutiveDetections})`);\r\n    }\r\n\r\n    // Reset cooldowns (call when user interaction occurs)\r\n    resetCooldowns() {\r\n        console.log(\"ðŸ”„ Cooldowns reset by user interaction\");\r\n        this.consecutiveDetections = 0;\r\n        this.lastDetectedCard = null;\r\n        this.lastDetectionTime = 0;\r\n    }\r\n\r\n    // Set edition selector state\r\n    setEditionSelectorOpen(isOpen) {\r\n        this.isEditionSelectorOpen = isOpen;\r\n        if (isOpen) {\r\n            console.log(\"ðŸŽ­ Edition selector opened - scanning paused\");\r\n        } else {\r\n            console.log(\"ðŸŽ­ Edition selector closed - scanning can resume\");\r\n            this.resetCooldowns(); // Reset when edition selector closes\r\n        }\r\n    }\r\n\r\n    // Get cooldown status for UI\r\n    getCooldownStatus() {\r\n        const now = Date.now();\r\n        return {\r\n            sameCardCooldown: this.lastDetectedCard ? Math.max(0, this.SAME_CARD_COOLDOWN - (now - this.lastDetectionTime)) : 0,\r\n            apiCooldown: Math.max(0, this.MIN_API_INTERVAL - (now - this.lastApiCall)),\r\n            consecutiveDetections: this.consecutiveDetections,\r\n            isEditionSelectorOpen: this.isEditionSelectorOpen,\r\n            canScan: this.shouldScan(this.lastDetectedCard)\r\n        };\r\n    }\r\n}\r\n\r\nconst Scanner = () => {\r\n    // Core scanner state\r\n    const [isScanning, setIsScanning] = useState(false);\r\n    const [scanResult, setScanResult] = useState(null);\r\n    const [cameraStatus, setCameraStatus] = useState('initializing');\r\n    const [currentCard, setCurrentCard] = useState(null);\r\n    const [scanMode, setScanMode] = useState('continuous');\r\n    \r\n    // Smart scanning state\r\n    const [continuousCount, setContinuousCount] = useState(0);\r\n    const [showContinueDialog, setShowContinueDialog] = useState(false);\r\n    const [autoSaveEnabled, setAutoSaveEnabled] = useState(true);\r\n    \r\n    // ðŸ”¥ NEW: Cooldown system state\r\n    const [cooldownStatus, setCooldownStatus] = useState({});\r\n    \r\n    // UI state\r\n    const [activeTab, setActiveTab] = useState('scanner');\r\n    const [scanHistory, setScanHistory] = useState([]);\r\n    const [isUIVisible, setIsUIVisible] = useState(true);\r\n    const [savedCards, setSavedCards] = useState([]);\r\n    \r\n    // Edition selection state\r\n    const [showEditionSelector, setShowEditionSelector] = useState(false);\r\n    const [availableEditions, setAvailableEditions] = useState([]);\r\n    const [pendingCardData, setPendingCardData] = useState(null);\r\n    const [pendingScanMode, setPendingScanMode] = useState(null);\r\n    const [scanningPausedForSelection, setScanningPausedForSelection] = useState(false);\r\n    \r\n    // AI Learning for edition preferences\r\n    const [editionPreferences, setEditionPreferences] = useState({});\r\n    \r\n    // Collection limits and premium features\r\n    const [isPremiumUser, setIsPremiumUser] = useState(false);\r\n    const [showPaywallModal, setShowPaywallModal] = useState(false);\r\n    const FREE_COLLECTION_LIMIT = 100;\r\n    \r\n    // Camera state with persistence\r\n    const [cameraError, setCameraError] = useState(null);\r\n    const [cameraRetryCount, setCameraRetryCount] = useState(0);\r\n    const [cameraInitializationComplete, setCameraInitializationComplete] = useState(false);\r\n    \r\n    // Refs\r\n    const videoRef = useRef(null);\r\n    const scanIntervalRef = useRef(null);\r\n    const visionServiceRef = useRef(null);\r\n    const cameraStreamRef = useRef(null);\r\n    const initializationPromiseRef = useRef(null);\r\n    \r\n    // ðŸ”¥ NEW: Cooldown system ref\r\n    const cooldownSystemRef = useRef(new MTGScannerCooldown());\r\n\r\n    // ðŸ”¥ Initialize services and camera ONCE\r\n    useEffect(() => {\r\n        console.log('ðŸ”§ Component mounting - initializing services...');\r\n        initializeServices();\r\n        loadSavedData();\r\n        \r\n        // Initialize camera ONCE\r\n        if (!initializationPromiseRef.current) {\r\n            console.log('ðŸš€ Starting PERSISTENT camera initialization...');\r\n            initializationPromiseRef.current = setupCamera();\r\n        }\r\n        \r\n        // Update cooldown status periodically\r\n        const cooldownUpdateInterval = setInterval(() => {\r\n            setCooldownStatus(cooldownSystemRef.current.getCooldownStatus());\r\n        }, 1000);\r\n        \r\n        return () => {\r\n            console.log('ðŸ§¹ Component unmounting - cleaning up...');\r\n            clearInterval(cooldownUpdateInterval);\r\n            cleanup();\r\n        };\r\n    }, []);\r\n\r\n    // Handle tab switching without stopping camera\r\n    useEffect(() => {\r\n        console.log(`ðŸŽ¯ Tab switched to: ${activeTab}`);\r\n        \r\n        if (activeTab === 'scanner' && cameraStreamRef.current && cameraStreamRef.current.active) {\r\n            console.log('ðŸŽ¯ Scanner tab active, ensuring video connection...');\r\n            if (videoRef.current && !videoRef.current.srcObject) {\r\n                console.log('ðŸ“· Reconnecting video element to persistent stream...');\r\n                videoRef.current.srcObject = cameraStreamRef.current;\r\n                videoRef.current.play();\r\n            }\r\n        }\r\n        \r\n        if (activeTab !== 'scanner' && isScanning) {\r\n            console.log('â¸ï¸ Pausing scanning - left scanner tab (camera stays active)');\r\n            stopScanning();\r\n        }\r\n    }, [activeTab]);\r\n\r\n    const initializeServices = () => {\r\n        console.log('ðŸ”§ Initializing MTG Scanner Pro...');\r\n        \r\n        try {\r\n            visionServiceRef.current = new ClaudeVisionService();\r\n            console.log('âœ… Gemini Vision Service initialized successfully');\r\n        } catch (error) {\r\n            console.error('âŒ Service initialization failed:', error);\r\n        }\r\n    };\r\n\r\n    const loadSavedData = () => {\r\n        try {\r\n            const saved = localStorage.getItem('mtg_saved_cards');\r\n            if (saved) {\r\n                setSavedCards(JSON.parse(saved));\r\n                console.log('ðŸ“ Loaded saved cards from storage');\r\n            }\r\n            \r\n            const preferences = localStorage.getItem('mtg_edition_preferences');\r\n            if (preferences) {\r\n                setEditionPreferences(JSON.parse(preferences));\r\n                console.log('ðŸ§  Loaded edition preferences for AI learning');\r\n            }\r\n            \r\n            const premiumStatus = localStorage.getItem('mtg_premium_status');\r\n            if (premiumStatus === 'true') {\r\n                setIsPremiumUser(true);\r\n                console.log('ðŸ’Ž Premium user status loaded');\r\n            }\r\n            \r\n        } catch (error) {\r\n            console.error('âŒ Failed to load saved data:', error);\r\n        }\r\n    };\r\n\r\n    // Camera setup with persistence\r\n    const setupCamera = async () => {\r\n        console.log('ðŸŽ¥ Setting up PERSISTENT camera for MTG Scanner Pro...');\r\n        setCameraStatus('requesting');\r\n        setCameraError(null);\r\n        \r\n        try {\r\n            if (!navigator.mediaDevices || !navigator.mediaDevices.getUserMedia) {\r\n                throw new Error('Camera API not supported in this browser');\r\n            }\r\n\r\n            if (cameraStreamRef.current && cameraStreamRef.current.active) {\r\n                console.log('ðŸ“· Camera stream already active, reusing persistent stream...');\r\n                \r\n                if (videoRef.current && !videoRef.current.srcObject) {\r\n                    videoRef.current.srcObject = cameraStreamRef.current;\r\n                    videoRef.current.play();\r\n                }\r\n                \r\n                setCameraStatus('ready');\r\n                setCameraInitializationComplete(true);\r\n                console.log('âœ… Camera reused successfully - PERSISTENT MODE ACTIVE');\r\n                return;\r\n            }\r\n\r\n            let stream = null;\r\n            \r\n            try {\r\n                console.log('ðŸ“· Attempting to use Logitech C920...');\r\n                const logitechConstraints = {\r\n                    video: {\r\n                        deviceId: { exact: '9b204eef73d1ed44be0ea768bfdb4c98dc4384c6cdc2fdabd82c6e863313382b' },\r\n                        width: { ideal: 1280 },\r\n                        height: { ideal: 720 },\r\n                        frameRate: { ideal: 30 }\r\n                    },\r\n                    audio: false\r\n                };\r\n                \r\n                stream = await navigator.mediaDevices.getUserMedia(logitechConstraints);\r\n                console.log('âœ… Successfully using Logitech C920!');\r\n                \r\n            } catch (logitechError) {\r\n                console.log('âš ï¸ Logitech C920 not available, trying general constraints...');\r\n                \r\n                const generalConstraints = {\r\n                    video: {\r\n                        width: { ideal: 1280, min: 320 },\r\n                        height: { ideal: 720, min: 240 },\r\n                        facingMode: { ideal: 'environment' },\r\n                        frameRate: { ideal: 30 }\r\n                    },\r\n                    audio: false\r\n                };\r\n                \r\n                stream = await navigator.mediaDevices.getUserMedia(generalConstraints);\r\n                console.log('âœ… Using fallback camera settings');\r\n            }\r\n            \r\n            cameraStreamRef.current = stream;\r\n            setCameraInitializationComplete(true);\r\n            \r\n            if (videoRef.current) {\r\n                videoRef.current.srcObject = stream;\r\n                videoRef.current.onloadedmetadata = () => {\r\n                    videoRef.current.play();\r\n                    setCameraStatus('ready');\r\n                    setCameraError(null);\r\n                    setCameraRetryCount(0);\r\n                    console.log('âœ… PERSISTENT Camera ready:', `${videoRef.current.videoWidth}x${videoRef.current.videoHeight}`);\r\n                    showCameraMessage('âœ… Camera ready with smart cooldown!', 'success');\r\n                };\r\n            }\r\n            \r\n        } catch (error) {\r\n            console.error('âŒ Camera setup failed:', error);\r\n            setCameraStatus('error');\r\n            handleCameraError(error);\r\n        }\r\n    };\r\n\r\n    const handleCameraError = (error) => {\r\n        let errorMessage = '';\r\n        let errorAction = '';\r\n        let canRetry = false;\r\n\r\n        switch (error.name) {\r\n            case 'NotAllowedError':\r\n                errorMessage = 'Camera permission denied';\r\n                errorAction = 'Please allow camera access and click \"Try Again\"';\r\n                canRetry = true;\r\n                break;\r\n            case 'NotFoundError':\r\n                errorMessage = 'No camera found';\r\n                errorAction = 'Please connect a camera or use a device with a camera';\r\n                canRetry = true;\r\n                break;\r\n            case 'NotReadableError':\r\n                errorMessage = 'Camera is busy';\r\n                errorAction = 'Please close other apps using the camera and try again';\r\n                canRetry = true;\r\n                break;\r\n            case 'OverconstrainedError':\r\n                errorMessage = 'Camera settings not supported';\r\n                errorAction = 'Trying with basic camera settings...';\r\n                canRetry = true;\r\n                break;\r\n            default:\r\n                errorMessage = error.message || 'Camera error';\r\n                errorAction = 'Please check your camera and try again';\r\n                canRetry = true;\r\n        }\r\n\r\n        setCameraError({ message: errorMessage, action: errorAction, canRetry });\r\n        \r\n        if (canRetry && cameraRetryCount < 2 && error.name !== 'NotAllowedError') {\r\n            const retryDelay = (cameraRetryCount + 1) * 2000;\r\n            console.log(`ðŸ”„ Auto-retrying camera setup in ${retryDelay/1000}s (attempt ${cameraRetryCount + 1}/2)`);\r\n            \r\n            setTimeout(() => {\r\n                setCameraRetryCount(prev => prev + 1);\r\n                setupCamera();\r\n            }, retryDelay);\r\n        }\r\n    };\r\n\r\n    const retryCameraSetup = () => {\r\n        console.log('ðŸ”„ Manual camera retry requested');\r\n        setCameraRetryCount(0);\r\n        setCameraError(null);\r\n        setCameraInitializationComplete(false);\r\n        initializationPromiseRef.current = null;\r\n        setupCamera();\r\n    };\r\n\r\n    const showCameraMessage = (message, type = 'info') => {\r\n        const messageDiv = document.createElement('div');\r\n        messageDiv.className = 'camera-toast-message';\r\n        messageDiv.innerHTML = message;\r\n        messageDiv.style.cssText = `\r\n            position: fixed;\r\n            top: 20px;\r\n            right: 20px;\r\n            background: ${type === 'success' ? '#28a745' : type === 'error' ? '#dc3545' : '#17a2b8'};\r\n            color: white;\r\n            padding: 12px 20px;\r\n            border-radius: 6px;\r\n            z-index: 10000;\r\n            font-weight: 500;\r\n            box-shadow: 0 4px 12px rgba(0,0,0,0.2);\r\n            max-width: 300px;\r\n        `;\r\n\r\n        document.body.appendChild(messageDiv);\r\n        \r\n        setTimeout(() => {\r\n            if (messageDiv.parentNode) {\r\n                messageDiv.parentNode.removeChild(messageDiv);\r\n            }\r\n        }, 3000);\r\n    };\r\n\r\n    // ðŸ”¥ MODIFIED: Smart scanning with cooldown system\r\n    const startScanning = () => {\r\n        if (!visionServiceRef.current || cameraStatus !== 'ready') {\r\n            console.log('âš ï¸ MTG Scanner not ready');\r\n            if (cameraStatus === 'error') {\r\n                showCameraMessage('âŒ Camera not ready. Please fix camera issues first.', 'error');\r\n            }\r\n            return;\r\n        }\r\n        \r\n        console.log(`â–¶ï¸ Starting MTG Scanner Pro with Smart Cooldown - ${scanMode} mode...`);\r\n        setIsScanning(true);\r\n        setScanningPausedForSelection(false);\r\n        \r\n        // ðŸ”¥ Reset cooldowns when starting scanning\r\n        cooldownSystemRef.current.resetCooldowns();\r\n        setCooldownStatus(cooldownSystemRef.current.getCooldownStatus());\r\n        \r\n        if (scanMode === 'continuous') {\r\n            setContinuousCount(0);\r\n            console.log('ðŸ”„ Continuous mode: Reset counter to 0');\r\n        }\r\n        \r\n        // ðŸ”¥ MODIFIED: Smart scanning interval with cooldown logic\r\n        scanIntervalRef.current = setInterval(async () => {\r\n            try {\r\n                // ðŸ”¥ Check cooldown system first\r\n                const currentCardName = currentCard?.cardName;\r\n                if (!cooldownSystemRef.current.shouldScan(currentCardName)) {\r\n                    // Update cooldown status for UI\r\n                    setCooldownStatus(cooldownSystemRef.current.getCooldownStatus());\r\n                    return; // Skip this frame due to cooldown\r\n                }\r\n\r\n                // Don't scan if edition selector is showing\r\n                if (scanningPausedForSelection || showEditionSelector) {\r\n                    console.log('â¸ï¸ Scanning paused for edition selection');\r\n                    cooldownSystemRef.current.setEditionSelectorOpen(true);\r\n                    return;\r\n                } else {\r\n                    cooldownSystemRef.current.setEditionSelectorOpen(false);\r\n                }\r\n\r\n                // ðŸ”¥ Frame change detection\r\n                const canvas = document.createElement('canvas');\r\n                const video = videoRef.current;\r\n                canvas.width = video.videoWidth;\r\n                canvas.height = video.videoHeight;\r\n                \r\n                const ctx = canvas.getContext('2d');\r\n                ctx.drawImage(video, 0, 0);\r\n                \r\n                // Get frame data for change detection\r\n                const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);\r\n                \r\n                // ðŸ”¥ Check if frame has changed significantly\r\n                if (!cooldownSystemRef.current.hasFrameChanged(imageData.data)) {\r\n                    console.log(\"ðŸ“· Frame unchanged, skipping scan\");\r\n                    return;\r\n                }\r\n\r\n                console.log(\"ðŸ”„ Processing frame for MTG CARD IDENTIFICATION...\");\r\n                \r\n                // Call the vision service\r\n                const result = await visionServiceRef.current.processVideoFrame(videoRef.current);\r\n                \r\n                if (result && result.hasCard && result.confidence >= 70) {\r\n                    console.log('ðŸŽ¯ MTG Card detected:', result.cardName, `(${result.confidence}%)`);\r\n                    \r\n                    // ðŸ”¥ Record detection in cooldown system\r\n                    cooldownSystemRef.current.recordDetection(result.cardName);\r\n                    setCooldownStatus(cooldownSystemRef.current.getCooldownStatus());\r\n                    \r\n                    // Stop scanning in single mode when card detected\r\n                    if (scanMode === 'single') {\r\n                        stopScanning();\r\n                    }\r\n                    \r\n                    // Always check for multiple editions\r\n                    await handleCardDetection(result);\r\n                    \r\n                } else if (result && !result.hasCard) {\r\n                    setScanResult({ hasCard: false, message: result.message || 'No MTG card detected' });\r\n                    setCurrentCard(null);\r\n                }\r\n                \r\n                // Update cooldown status\r\n                setCooldownStatus(cooldownSystemRef.current.getCooldownStatus());\r\n                \r\n            } catch (error) {\r\n                console.error('âŒ Scanning error:', error);\r\n                setScanResult({ hasCard: false, message: 'Scanner error - please try again' });\r\n            }\r\n        }, scanMode === 'single' ? 500 : 1000);\r\n    };\r\n\r\n    // Handle card detection with cooldown integration\r\n    const handleCardDetection = async (detectedCard) => {\r\n        try {\r\n            console.log('ðŸŽ­ Checking for multiple editions of:', detectedCard.cardName);\r\n            \r\n            const cardName = detectedCard.cardName.trim();\r\n            const searchQuery = `!\"${cardName}\"`;\r\n            const encodedQuery = encodeURIComponent(searchQuery);\r\n            \r\n            console.log('ðŸ” Scryfall search query:', searchQuery);\r\n            \r\n            const editionsResponse = await fetch(\r\n                `https://api.scryfall.com/cards/search?q=${encodedQuery}&unique=prints&order=released&dir=desc`\r\n            );\r\n            \r\n            if (editionsResponse.ok) {\r\n                const editionsData = await editionsResponse.json();\r\n                const editions = editionsData.data || [];\r\n                \r\n                console.log(`ðŸ“Š Scryfall returned ${editions.length} total results`);\r\n                \r\n                const exactMatches = editions.filter(card => {\r\n                    const cardNameNormalized = card.name.toLowerCase().trim();\r\n                    const searchNameNormalized = cardName.toLowerCase().trim();\r\n                    return cardNameNormalized === searchNameNormalized;\r\n                });\r\n                \r\n                console.log(`ðŸŽ¯ Found ${exactMatches.length} exact name matches for \"${cardName}\"`);\r\n                \r\n                exactMatches.forEach((card, index) => {\r\n                    console.log(`   ${index + 1}. ${card.set_name} (${card.set.toUpperCase()}) - ${card.released_at}`);\r\n                });\r\n                \r\n                if (exactMatches.length > 1) {\r\n                    // ðŸ”¥ Notify cooldown system of edition selector opening\r\n                    console.log(`ðŸŽ­ Multiple editions found - pausing scanner for selection`);\r\n                    setScanningPausedForSelection(true);\r\n                    cooldownSystemRef.current.setEditionSelectorOpen(true);\r\n                    \r\n                    const sortedEditions = sortEditionsByPreference(cardName, exactMatches);\r\n                    \r\n                    setPendingCardData(detectedCard);\r\n                    setPendingScanMode(scanMode);\r\n                    setAvailableEditions(sortedEditions);\r\n                    setShowEditionSelector(true);\r\n                    \r\n                    setScanResult(null);\r\n                    setCurrentCard(null);\r\n                    return;\r\n                    \r\n                } else if (exactMatches.length === 1) {\r\n                    console.log(`âœ… Single edition found: ${exactMatches[0].set_name} (${exactMatches[0].set.toUpperCase()})`);\r\n                    const enhancedCard = enhanceCardWithScryfall(detectedCard, exactMatches[0]);\r\n                    displayCard(enhancedCard);\r\n                    \r\n                    if (scanMode === 'continuous' && autoSaveEnabled) {\r\n                        const saved = await saveCardToCollection(enhancedCard);\r\n                        if (saved) {\r\n                            console.log(`ðŸ’¾ AUTO-SAVED: ${enhancedCard.cardName} to collection`);\r\n                            handleContinuousCounterAndLimit();\r\n                        }\r\n                    }\r\n                    \r\n                } else {\r\n                    console.log('âš ï¸ No exact Scryfall matches found, using original detection');\r\n                    displayCard(detectedCard);\r\n                    \r\n                    if (scanMode === 'continuous' && autoSaveEnabled) {\r\n                        const saved = await saveCardToCollection(detectedCard);\r\n                        if (saved) {\r\n                            console.log(`ðŸ’¾ AUTO-SAVED: ${detectedCard.cardName} to collection (no Scryfall match)`);\r\n                            handleContinuousCounterAndLimit();\r\n                        }\r\n                    }\r\n                }\r\n            } else {\r\n                const errorText = await editionsResponse.text();\r\n                console.log('âŒ Scryfall API error:', editionsResponse.status, errorText);\r\n                displayCard(detectedCard);\r\n            }\r\n        } catch (error) {\r\n            console.error('âŒ Edition lookup error:', error);\r\n            displayCard(detectedCard);\r\n        }\r\n    };\r\n\r\n    // AI Learning - Sort editions by user preferences\r\n    const sortEditionsByPreference = (cardName, editions) => {\r\n        const cardKey = cardName.toLowerCase().trim();\r\n        const userPreference = editionPreferences[cardKey];\r\n        \r\n        if (userPreference) {\r\n            console.log(`ðŸ§  AI Learning: User previously preferred ${userPreference} for ${cardName}`);\r\n            \r\n            return editions.sort((a, b) => {\r\n                if (a.set === userPreference) return -1;\r\n                if (b.set === userPreference) return 1;\r\n                return 0;\r\n            });\r\n        }\r\n        \r\n        return editions;\r\n    };\r\n\r\n    const learnEditionPreference = (cardName, selectedEdition) => {\r\n        const cardKey = cardName.toLowerCase().trim();\r\n        const newPreferences = {\r\n            ...editionPreferences,\r\n            [cardKey]: selectedEdition.set\r\n        };\r\n        \r\n        setEditionPreferences(newPreferences);\r\n        localStorage.setItem('mtg_edition_preferences', JSON.stringify(newPreferences));\r\n        \r\n        console.log(`ðŸ§  AI Learning: Remembered ${selectedEdition.set_name} preference for ${cardName}`);\r\n    };\r\n\r\n    const handleContinuousCounterAndLimit = () => {\r\n        const newCount = continuousCount + 1;\r\n        setContinuousCount(newCount);\r\n        \r\n        if (newCount >= 10) {\r\n            console.log('ðŸ›‘ CONTINUOUS MODE: 10-card limit reached, pausing...');\r\n            stopScanning();\r\n            setShowContinueDialog(true);\r\n        }\r\n    };\r\n\r\n    const handleContinueScanning = () => {\r\n        console.log('ðŸ”„ User chose to continue scanning...');\r\n        setShowContinueDialog(false);\r\n        setContinuousCount(0);\r\n        // ðŸ”¥ Reset cooldowns when continuing\r\n        cooldownSystemRef.current.resetCooldowns();\r\n        startScanning();\r\n    };\r\n\r\n    const handleStopScanning = () => {\r\n        console.log('â¹ï¸ User chose to stop scanning at 10-card limit');\r\n        setShowContinueDialog(false);\r\n        setContinuousCount(0);\r\n    };\r\n\r\n    const enhanceCardWithScryfall = (originalCard, scryfallCard) => {\r\n        return {\r\n            ...originalCard,\r\n            cardType: scryfallCard.type_line,\r\n            manaCost: scryfallCard.mana_cost,\r\n            setInfo: scryfallCard.set_name,\r\n            rarity: scryfallCard.rarity,\r\n            scryfallId: scryfallCard.id,\r\n            scryfallImageUrl: scryfallCard.image_uris?.normal || scryfallCard.image_uris?.large,\r\n            scryfallUri: scryfallCard.scryfall_uri,\r\n            prices: scryfallCard.prices,\r\n            collectorNumber: scryfallCard.collector_number,\r\n            releaseDate: scryfallCard.released_at,\r\n            scryfallVerified: true,\r\n            setCode: scryfallCard.set\r\n        };\r\n    };\r\n\r\n    const displayCard = (card) => {\r\n        setCurrentCard(card);\r\n        setScanResult(card);\r\n        \r\n        setScanHistory(prev => {\r\n            const isDuplicate = prev.some(historyCard => \r\n                historyCard.cardName === card.cardName && \r\n                Math.abs(new Date(historyCard.timestamp) - new Date(card.timestamp)) < 5000\r\n            );\r\n            \r\n            if (!isDuplicate) {\r\n                return [card, ...prev.slice(0, 19)];\r\n            }\r\n            return prev;\r\n        });\r\n    };\r\n\r\n    // Handle edition selection with cooldown integration\r\n    const handleEditionSelected = async (selectedEdition) => {\r\n        if (pendingCardData && selectedEdition) {\r\n            const enhancedCard = enhanceCardWithScryfall(pendingCardData, selectedEdition);\r\n            displayCard(enhancedCard);\r\n            \r\n            console.log(`âœ… User selected: ${selectedEdition.set_name} (${selectedEdition.set.toUpperCase()})`);\r\n            \r\n            learnEditionPreference(pendingCardData.cardName, selectedEdition);\r\n            \r\n            if (pendingScanMode === 'continuous' && autoSaveEnabled) {\r\n                const saved = await saveCardToCollection(enhancedCard);\r\n                if (saved) {\r\n                    console.log(`ðŸ’¾ AUTO-SAVED: ${enhancedCard.cardName} to collection`);\r\n                    handleContinuousCounterAndLimit();\r\n                }\r\n                \r\n                if (continuousCount < 9) {\r\n                    console.log('ðŸ”„ Resuming continuous scanning after edition selection...');\r\n                    setTimeout(() => {\r\n                        setScanningPausedForSelection(false);\r\n                        // ðŸ”¥ Reset cooldowns after edition selection\r\n                        cooldownSystemRef.current.setEditionSelectorOpen(false);\r\n                        if (!isScanning) {\r\n                            startScanning();\r\n                        }\r\n                    }, 1000);\r\n                }\r\n            }\r\n        }\r\n        \r\n        // ðŸ”¥ Close edition selector and notify cooldown system\r\n        setShowEditionSelector(false);\r\n        setAvailableEditions([]);\r\n        setPendingCardData(null);\r\n        setPendingScanMode(null);\r\n        setScanningPausedForSelection(false);\r\n        cooldownSystemRef.current.setEditionSelectorOpen(false);\r\n        setCooldownStatus(cooldownSystemRef.current.getCooldownStatus());\r\n    };\r\n\r\n    const handleEditionCancelled = async () => {\r\n        if (pendingCardData) {\r\n            displayCard(pendingCardData);\r\n            \r\n            if (pendingScanMode === 'continuous' && autoSaveEnabled) {\r\n                const saved = await saveCardToCollection(pendingCardData);\r\n                if (saved) {\r\n                    console.log(`ðŸ’¾ AUTO-SAVED: ${pendingCardData.cardName} to collection (cancelled edition selection)`);\r\n                    handleContinuousCounterAndLimit();\r\n                }\r\n                \r\n                if (continuousCount < 9) {\r\n                    console.log('ðŸ”„ Resuming continuous scanning after cancellation...');\r\n                    setTimeout(() => {\r\n                        setScanningPausedForSelection(false);\r\n                        cooldownSystemRef.current.setEditionSelectorOpen(false);\r\n                        if (!isScanning) {\r\n                            startScanning();\r\n                        }\r\n                    }, 1000);\r\n                }\r\n            }\r\n        }\r\n        \r\n        // ðŸ”¥ Close edition selector and notify cooldown system\r\n        setShowEditionSelector(false);\r\n        setAvailableEditions([]);\r\n        setPendingCardData(null);\r\n        setPendingScanMode(null);\r\n        setScanningPausedForSelection(false);\r\n        cooldownSystemRef.current.setEditionSelectorOpen(false);\r\n        setCooldownStatus(cooldownSystemRef.current.getCooldownStatus());\r\n    };\r\n\r\n    // Stop scanning but keep camera active\r\n    const stopScanning = () => {\r\n        console.log('â¹ï¸ Stopping MTG Scanner (camera stays active for persistence)...');\r\n        setIsScanning(false);\r\n        setScanningPausedForSelection(false);\r\n        \r\n        if (scanIntervalRef.current) {\r\n            clearInterval(scanIntervalRef.current);\r\n            scanIntervalRef.current = null;\r\n        }\r\n        \r\n        console.log('ðŸ“· Camera stream preserved for tab persistence');\r\n    };\r\n\r\n    // Only cleanup camera on component unmount\r\n    const cleanup = () => {\r\n        console.log('ðŸ§¹ Cleaning up MTG Scanner...');\r\n        stopScanning();\r\n        \r\n        if (cameraStreamRef.current) {\r\n            console.log('ðŸ“· Stopping persistent camera stream...');\r\n            cameraStreamRef.current.getTracks().forEach(track => track.stop());\r\n            cameraStreamRef.current = null;\r\n            setCameraInitializationComplete(false);\r\n        }\r\n        \r\n        if (videoRef.current && videoRef.current.srcObject) {\r\n            const tracks = videoRef.current.srcObject.getTracks();\r\n            tracks.forEach(track => track.stop());\r\n            videoRef.current.srcObject = null;\r\n        }\r\n        \r\n        initializationPromiseRef.current = null;\r\n    };\r\n\r\n    // Collection management\r\n    const saveCardToCollection = async (card) => {\r\n        try {\r\n            if (!isPremiumUser && savedCards.length >= FREE_COLLECTION_LIMIT) {\r\n                console.log('ðŸš¨ Free collection limit reached');\r\n                setShowPaywallModal(true);\r\n                return false;\r\n            }\r\n            \r\n            const cardWithId = {\r\n                ...card,\r\n                id: Date.now() + Math.random(),\r\n                addedAt: new Date().toISOString(),\r\n                scannedAt: new Date().toLocaleString()\r\n            };\r\n            \r\n            const updatedCards = [cardWithId, ...savedCards];\r\n            setSavedCards(updatedCards);\r\n            \r\n            localStorage.setItem('mtg_saved_cards', JSON.stringify(updatedCards));\r\n            \r\n            console.log('ðŸ’¾ Card saved to collection:', card.cardName);\r\n            \r\n            if (scanMode === 'single') {\r\n                setScanResult(prev => ({\r\n                    ...prev,\r\n                    savedToCollection: true,\r\n                    message: `âœ… ${card.cardName} saved to collection!`\r\n                }));\r\n                \r\n                setTimeout(() => {\r\n                    setScanResult(prev => ({\r\n                        ...prev,\r\n                        savedToCollection: false,\r\n                        message: undefined\r\n                    }));\r\n                }, 3000);\r\n            }\r\n            \r\n            return true;\r\n            \r\n        } catch (error) {\r\n            console.error('âŒ Failed to save card:', error);\r\n            setScanResult(prev => ({\r\n                ...prev,\r\n                message: `âŒ Failed to save ${card.cardName}`\r\n            }));\r\n            return false;\r\n        }\r\n    };\r\n\r\n    const handleUpgradeToPremium = () => {\r\n        console.log('ðŸ’Ž Initiating PayPal payment for premium upgrade...');\r\n        \r\n        const paypalLink = `https://www.paypal.com/paypalme/thediceyguy/9.99?country.x=US&locale.x=en_US`;\r\n        window.open(paypalLink, '_blank');\r\n        \r\n        setTimeout(() => {\r\n            setIsPremiumUser(true);\r\n            localStorage.setItem('mtg_premium_status', 'true');\r\n            setShowPaywallModal(false);\r\n            showCameraMessage('ðŸ’Ž Premium upgrade successful! Unlimited collection storage activated.', 'success');\r\n        }, 5000);\r\n    };\r\n\r\n    const removeCardFromCollection = (cardId) => {\r\n        try {\r\n            const updatedCards = savedCards.filter(card => card.id !== cardId);\r\n            setSavedCards(updatedCards);\r\n            localStorage.setItem('mtg_saved_cards', JSON.stringify(updatedCards));\r\n            console.log('ðŸ—‘ï¸ Card removed from collection');\r\n        } catch (error) {\r\n            console.error('âŒ Failed to remove card:', error);\r\n        }\r\n    };\r\n\r\n    const openCardInScryfall = (card) => {\r\n        if (card && card.cardName) {\r\n            const searchUrl = `https://scryfall.com/search?q=${encodeURIComponent(card.cardName)}`;\r\n            window.open(searchUrl, '_blank');\r\n            console.log('ðŸ”— Opening Scryfall for:', card.cardName);\r\n        }\r\n    };\r\n\r\n    const toggleUIVisibility = () => {\r\n        setIsUIVisible(!isUIVisible);\r\n        console.log('ðŸ‘ï¸ UI visibility toggled:', !isUIVisible);\r\n    };\r\n\r\n    // Tab switching handler that preserves camera\r\n    const handleTabSwitch = (newTab) => {\r\n        console.log(`ðŸ”„ Switching from ${activeTab} to ${newTab} (camera preserved)`);\r\n        setActiveTab(newTab);\r\n        \r\n        if (newTab === 'scanner' && cameraStreamRef.current && videoRef.current) {\r\n            setTimeout(() => {\r\n                if (!videoRef.current.srcObject) {\r\n                    console.log('ðŸ“· Reconnecting video element to persistent camera stream...');\r\n                    videoRef.current.srcObject = cameraStreamRef.current;\r\n                    videoRef.current.play();\r\n                }\r\n            }, 100);\r\n        }\r\n    };\r\n\r\n    const getCameraStatusDisplay = () => {\r\n        switch (cameraStatus) {\r\n            case 'initializing':\r\n                return { text: 'ðŸ”§ Initializing...', class: 'status-initializing' };\r\n            case 'requesting':\r\n                return { text: 'ðŸ“· Requesting access...', class: 'status-requesting' };\r\n            case 'ready':\r\n                return { text: 'âœ… HD Camera Ready + Smart Cooldown', class: 'status-ready' };\r\n            case 'error':\r\n                return { text: 'âŒ Camera Error', class: 'status-error' };\r\n            default:\r\n                return { text: 'â³ Setting up...', class: 'status-default' };\r\n        }\r\n    };\r\n\r\n    // ðŸ”¥ NEW: Render cooldown status UI\r\n    const renderCooldownStatus = () => {\r\n        if (!cooldownStatus || activeTab !== 'scanner') return null;\r\n        \r\n        return (\r\n            <div style={{\r\n                position: 'absolute',\r\n                top: '10px',\r\n                right: '10px',\r\n                background: 'rgba(0,0,0,0.8)',\r\n                color: 'white',\r\n                padding: '12px',\r\n                borderRadius: '8px',\r\n                fontSize: '11px',\r\n                fontFamily: 'monospace',\r\n                border: '1px solid #4a90e2',\r\n                minWidth: '200px',\r\n                zIndex: 1000\r\n            }}>\r\n                <div style={{color: '#4a90e2', fontWeight: 'bold', marginBottom: '6px'}}>\r\n                    ðŸ”¥ Smart Cooldown System\r\n                </div>\r\n                <div>API Cooldown: {Math.ceil(cooldownStatus.apiCooldown / 1000)}s</div>\r\n                <div>Same Card: {Math.ceil(cooldownStatus.sameCardCooldown / 1000)}s</div>\r\n                <div>Consecutive: {cooldownStatus.consecutiveDetections}/3</div>\r\n                <div>Edition Selector: {cooldownStatus.isEditionSelectorOpen ? 'ðŸŽ­ Open' : 'âœ… Closed'}</div>\r\n                <div style={{\r\n                    marginTop: '6px', \r\n                    padding: '4px', \r\n                    background: cooldownStatus.canScan ? 'rgba(40, 167, 69, 0.3)' : 'rgba(220, 53, 69, 0.3)',\r\n                    borderRadius: '4px',\r\n                    textAlign: 'center',\r\n                    fontWeight: 'bold'\r\n                }}>\r\n                    {cooldownStatus.canScan ? 'âœ… Can Scan' : 'âŒ Cooldown Active'}\r\n                </div>\r\n            </div>\r\n        );\r\n    };\r\n\r\n    const cameraStatus_display = getCameraStatusDisplay();\r\n\r\n    return (\r\n        <div className=\"mtg-scanner-pro\">\r\n            {/* Header */}\r\n            <div className=\"app-header\">\r\n                <div className=\"app-title-section\">\r\n                    <div className=\"app-logo\">\r\n                        <img \r\n                            src=\"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgdmlld0JveD0iMCAwIDEwMCAxMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHg9IjUiIHk9IjUiIHdpZHRoPSI5MCIgaGVpZ2h0PSI5MCIgcng9IjEwIiBzdHJva2U9IndoaXRlIiBzdHJva2Utd2lkdGg9IjMiIGZpbGw9IiMyMzI3MkEiLz4KPHRleHQgeD0iNTAiIHk9IjM1IiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmaWxsPSJ3aGl0ZSIgZm9udC1mYW1pbHk9IkFyaWFsLCBzYW5zLXNlcmlmIiBmb250LXNpemU9IjE4IiBmb250LXdlaWdodD0iYm9sZCI+TVRHPC90ZXh0Pgo8bGluZSB4MT0iMTUiIHkxPSI1MCIgeDI9Ijg1IiB5Mj0iNTAiIHN0cm9rZT0iIzRBOTBFMiIgc3Ryb2tlLXdpZHRoPSIzIi8+Cjx0ZXh0IHg9IjUwIiB5PSI3NSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZmlsbD0id2hpdGUiIGZvbnQtZmFtaWx5PSJBcmlhbCwgc2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgZm9udC13ZWlnaHQ9ImJvbGQiPlNDQU5ORVI8L3RleHQ+Cjwvc3ZnPgo=\"\r\n                            alt=\"MTG Scanner Logo\"\r\n                            className=\"logo-image\"\r\n                        />\r\n                    </div>\r\n                    <div className=\"app-title\">\r\n                        <h1>MTG Scanner Pro</h1>\r\n                        <span className=\"app-subtitle\">\r\n                            ðŸ”¥ Smart Cooldown System â€¢ {isPremiumUser ? 'ðŸ’Ž Premium' : `${FREE_COLLECTION_LIMIT - savedCards.length} cards left`}\r\n                        </span>\r\n                    </div>\r\n                </div>\r\n                \r\n                <div className=\"header-stats\">\r\n                    <div className=\"stat-item\">\r\n                        <span className=\"stat-label\">Accuracy:</span>\r\n                        <span className=\"stat-value\">98%</span>\r\n                    </div>\r\n                    <div className=\"stat-item\">\r\n                        <span className=\"stat-label\">AI Learned:</span>\r\n                        <span className=\"stat-value\">{Object.keys(editionPreferences).length}</span>\r\n                    </div>\r\n                    <div className=\"stat-item\">\r\n                        <span className=\"stat-label\">Cooldowns:</span>\r\n                        <span className=\"stat-value\">{cooldownStatus.canScan ? 'âœ…' : 'â¸ï¸'}</span>\r\n                    </div>\r\n                    <div className=\"stat-item\">\r\n                        <span className=\"stat-label\">Saved:</span>\r\n                        <span className=\"stat-value\">\r\n                            {savedCards.length}{!isPremiumUser && `/${FREE_COLLECTION_LIMIT}`}\r\n                        </span>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Tab Navigation */}\r\n            <div className=\"tab-navigation\">\r\n                <button\r\n                    className={`tab-btn ${activeTab === 'scanner' ? 'active' : ''}`}\r\n                    onClick={() => handleTabSwitch('scanner')}\r\n                >\r\n                    ðŸ” Scanner {scanningPausedForSelection && 'â¸ï¸'} {cooldownStatus.canScan ? 'ðŸ”¥' : 'â³'}\r\n                </button>\r\n                <button\r\n                    className={`tab-btn ${activeTab === 'deck' ? 'active' : ''}`}\r\n                    onClick={() => handleTabSwitch('deck')}\r\n                >\r\n                    ðŸƒ Collection ({savedCards.length}{!isPremiumUser && `/${FREE_COLLECTION_LIMIT}`})\r\n                </button>\r\n                <button\r\n                    className={`tab-btn ${activeTab === 'knowledge' ? 'active' : ''}`}\r\n                    onClick={() => handleTabSwitch('knowledge')}\r\n                >\r\n                    ðŸ“š MTG Knowledge\r\n                </button>\r\n            </div>\r\n\r\n            {/* Main Content Area */}\r\n            <div className=\"main-content\">\r\n                \r\n                {/* Scanner Tab */}\r\n                {activeTab === 'scanner' && (\r\n                    <div className=\"scanner-tab\">\r\n                        <div className=\"scanner-section\">\r\n                            {/* Video Feed */}\r\n                            <div className=\"video-container\">\r\n                                <video\r\n                                    ref={videoRef}\r\n                                    className=\"scanner-video\"\r\n                                    autoPlay\r\n                                    playsInline\r\n                                    muted\r\n                                />\r\n                                \r\n                                {/* ðŸ”¥ NEW: Cooldown Status Overlay */}\r\n                                {renderCooldownStatus()}\r\n                                \r\n                                {/* Camera Status Overlay */}\r\n                                <div className=\"camera-status-overlay\">\r\n                                    <div className={`status-indicator ${cameraStatus_display.class}`}>\r\n                                        {cameraStatus_display.text}\r\n                                        {cameraInitializationComplete && ' ðŸ”„ Persistent Mode'}\r\n                                    </div>\r\n                                </div>\r\n                                \r\n                                {/* Camera Error Overlay */}\r\n                                {cameraError && (\r\n                                    <div className=\"camera-error-overlay\">\r\n                                        <div className=\"camera-error-card\">\r\n                                            <h3>ðŸ“¹ Camera Issue</h3>\r\n                                            <p><strong>{cameraError.message}</strong></p>\r\n                                            <p>{cameraError.action}</p>\r\n                                            {cameraError.canRetry && (\r\n                                                <button \r\n                                                    onClick={retryCameraSetup}\r\n                                                    className=\"retry-camera-btn\"\r\n                                                >\r\n                                                    ðŸ”„ Try Again\r\n                                                </button>\r\n                                            )}\r\n                                        </div>\r\n                                    </div>\r\n                                )}\r\n                                \r\n                                {/* Scanning Overlay */}\r\n                                {isScanning && !scanningPausedForSelection && (\r\n                                    <div className=\"scanning-overlay\">\r\n                                        <div className=\"scan-frame\"></div>\r\n                                        <div className=\"scan-instructions\">\r\n                                            ðŸ” Position MTG card in frame\r\n                                            <div className=\"scan-tech\">\r\n                                                {scanMode === 'continuous' ? \r\n                                                    `ðŸ”¥ Smart cooldown mode (${continuousCount}/10)` : \r\n                                                    'ðŸ“· Single shot with smart cooldown'\r\n                                                }\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n                                )}\r\n                                \r\n                                {/* Edition Selection Pause Overlay */}\r\n                                {scanningPausedForSelection && (\r\n                                    <div className=\"scanning-overlay\">\r\n                                        <div className=\"scan-frame\" style={{borderColor: '#ffa500'}}></div>\r\n                                        <div className=\"scan-instructions\">\r\n                                            â¸ï¸ Scanner paused for edition selection\r\n                                            <div className=\"scan-tech\">\r\n                                                ðŸŽ­ Choose the correct edition below\r\n                                            </div>\r\n                                        </div>\r\n                                    </div>\r\n                                )}\r\n                            </div>\r\n\r\n                            {/* Scanner Controls */}\r\n                            <div className=\"scanner-controls\">\r\n                                {/* Scan Mode Toggle */}\r\n                                <div className=\"scan-mode-section\">\r\n                                    <label className=\"scan-mode-label\">Scan Mode:</label>\r\n                                    <div className=\"scan-mode-toggle\">\r\n                                        <button\r\n                                            className={`mode-btn ${scanMode === 'continuous' ? 'active' : ''}`}\r\n                                            onClick={() => setScanMode('continuous')}\r\n                                            disabled={isScanning || showEditionSelector}\r\n                                        >\r\n                                            ðŸ”¥ Smart Continuous {scanMode === 'continuous' && `(${continuousCount}/10)`}\r\n                                        </button>\r\n                                        <button\r\n                                            className={`mode-btn ${scanMode === 'single' ? 'active' : ''}`}\r\n                                            onClick={() => setScanMode('single')}\r\n                                            disabled={isScanning || showEditionSelector}\r\n                                        >\r\n                                            ðŸ“· Smart Single Shot\r\n                                        </button>\r\n                                    </div>\r\n                                </div>\r\n\r\n                                {/* Start/Stop Button */}\r\n                                <button\r\n                                    className={`scan-btn ${isScanning ? 'scanning' : 'ready'}`}\r\n                                    onClick={isScanning ? stopScanning : startScanning}\r\n                                    disabled={cameraStatus !== 'ready' || showEditionSelector}\r\n                                >\r\n                                    {showEditionSelector ? 'ðŸŽ­ Choose Edition Below' :\r\n                                     scanningPausedForSelection ? 'â¸ï¸ Paused for Selection' :\r\n                                     isScanning ? 'â¹ï¸ Stop Smart Scanning' : \r\n                                     `ðŸ”¥ Start Smart ${scanMode === 'single' ? 'Single' : 'Continuous'} Scan`}\r\n                                </button>\r\n                                \r\n                                {/* Camera Retry Button */}\r\n                                {cameraStatus === 'error' && (\r\n                                    <button\r\n                                        className=\"retry-camera-btn\"\r\n                                        onClick={retryCameraSetup}\r\n                                        title=\"Retry camera initialization\"\r\n                                    >\r\n                                        ðŸ”„ Fix Camera\r\n                                    </button>\r\n                                )}\r\n                                \r\n                                <button\r\n                                    className=\"ui-toggle-btn\"\r\n                                    onClick={toggleUIVisibility}\r\n                                    title=\"Toggle card information display\"\r\n                                >\r\n                                    {isUIVisible ? 'ðŸ‘ï¸ Hide Info' : 'ðŸ‘ï¸ Show Info'}\r\n                                </button>\r\n\r\n                                {/* ðŸ”¥ NEW: Reset Cooldowns Button */}\r\n                                <button\r\n                                    className=\"debug-btn\"\r\n                                    onClick={() => {\r\n                                        cooldownSystemRef.current.resetCooldowns();\r\n                                        setCooldownStatus(cooldownSystemRef.current.getCooldownStatus());\r\n                                        console.log('ðŸ”„ Cooldowns manually reset');\r\n                                        showCameraMessage('ðŸ”„ Cooldowns reset!', 'success');\r\n                                    }}\r\n                                    title=\"Reset all cooldowns\"\r\n                                    style={{\r\n                                        background: '#28a745',\r\n                                        color: 'white',\r\n                                        border: 'none',\r\n                                        padding: '8px 16px',\r\n                                        borderRadius: '4px',\r\n                                        cursor: 'pointer',\r\n                                        fontSize: '12px'\r\n                                    }}\r\n                                >\r\n                                    ðŸ”„ Reset Cooldowns\r\n                                </button>\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* Card Display UI */}\r\n                        {isUIVisible && (\r\n                            <div className=\"card-info-section\">\r\n                                <CardDisplayUI\r\n                                    scanResult={scanResult}\r\n                                    isScanning={isScanning}\r\n                                    onSaveCard={saveCardToCollection}\r\n                                    onOpenScryfall={openCardInScryfall}\r\n                                    scanHistory={scanHistory}\r\n                                />\r\n                            </div>\r\n                        )}\r\n                    </div>\r\n                )}\r\n\r\n                {/* Collection/Deck Tab */}\r\n                {activeTab === 'deck' && (\r\n                    <div className=\"deck-tab\">\r\n                        <DeckManager \r\n                            savedCards={savedCards}\r\n                            onRemoveCard={removeCardFromCollection}\r\n                            onOpenScryfall={openCardInScryfall}\r\n                            scanHistory={scanHistory}\r\n                            isPremiumUser={isPremiumUser}\r\n                            collectionLimit={FREE_COLLECTION_LIMIT}\r\n                            onUpgrade={handleUpgradeToPremium}\r\n                        />\r\n                    </div>\r\n                )}\r\n\r\n                {/* Knowledge Tab */}\r\n                {activeTab === 'knowledge' && (\r\n                    <div className=\"knowledge-tab\">\r\n                        <MTGKnowledgeBase \r\n                            currentCard={currentCard}\r\n                            savedCards={savedCards}\r\n                            editionPreferences={editionPreferences}\r\n                        />\r\n                    </div>\r\n                )}\r\n            </div>\r\n\r\n            {/* Status Bar */}\r\n            <div className=\"status-bar\">\r\n                <div className=\"status-left\">\r\n                    {scanHistory.length > 0 && (\r\n                        <>\r\n                            <span className=\"status-item\">ðŸ“Š Scanned: {scanHistory.length}</span>\r\n                            {currentCard && (\r\n                                <span className=\"status-item\">\r\n                                    ðŸŽ¯ Last: {currentCard.cardName} ({currentCard.confidence}%)\r\n                                </span>\r\n                            )}\r\n                        </>\r\n                    )}\r\n                </div>\r\n                <div className=\"status-right\">\r\n                    <div className=\"footer-logo\">\r\n                        <img \r\n                            src=\"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgdmlld0JveD0iMCAwIDEwMCAxMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHg9IjUiIHk9IjUiIHdpZHRoPSI5MCIgaGVpZ2h0PSI5MCIgcng9IjEwIiBzdHJva2U9IndoaXRlIiBzdHJva2Utd2lkdGg9IjMiIGZpbGw9IiMyMzI3MkEiLz4KPHRleHQgeD0iNTAiIHk9IjM1IiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmaWxsPSJ3aGl0ZSIgZm9udC1mYW1pbHk9IkFyaWFsLCBzYW5zLXNlcmlmIiBmb250LXNpemU9IjE4IiBmb250LXdlaWdodD0iYm9sZCI+TVRHPC90ZXh0Pgo8bGluZSB4MT0iMTUiIHkxPSI1MCIgeDI9Ijg1IiB5Mj0iNTAiIHN0cm9rZT0iIzRBOTBFMiIgc3Ryb2tlLXdpZHRoPSIzIi8+Cjx0ZXh0IHg9IjUwIiB5PSI3NSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZmlsbD0id2hpdGUiIGZvbnQtZmFtaWx5PSJBcmlhbCwgc2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgZm9udC13ZWlnaHQ9ImJvbGQiPlNDQU5ORVI8L3RleHQ+Cjwvc3ZnPgo=\"\r\n                            alt=\"MTG Scanner\"\r\n                        />\r\n                        MTG Scanner\r\n                    </div>\r\n                    <span className=\"status-item\">ðŸ”¥ Smart Cooldown: {cooldownStatus.canScan ? 'Ready' : 'Active'}</span>\r\n                    <span className=\"status-item\">\r\n                        ðŸ“· Camera: {cameraInitializationComplete ? 'Persistent âœ…' : 'Initializing â³'}\r\n                    </span>\r\n                    <span className=\"status-item\">ðŸ§  AI Learning: {Object.keys(editionPreferences).length} cards</span>\r\n                    <span className=\"status-item\">ðŸ“¡ Scryfall Database</span>\r\n                    <span className=\"status-item\">{isPremiumUser ? 'ðŸ’Ž Premium' : 'ðŸ†“ Free'}</span>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Edition Selector Modal */}\r\n            {showEditionSelector && (\r\n                <EditionSelector\r\n                    cardName={pendingCardData?.cardName}\r\n                    availableEditions={availableEditions}\r\n                    onEditionSelected={handleEditionSelected}\r\n                    onCancel={handleEditionCancelled}\r\n                    aiRecommendation={editionPreferences[pendingCardData?.cardName?.toLowerCase()?.trim()]}\r\n                />\r\n            )}\r\n\r\n            {/* Premium Upgrade Paywall Modal */}\r\n            {showPaywallModal && (\r\n                <div style={{\r\n                    position: 'fixed',\r\n                    top: 0,\r\n                    left: 0,\r\n                    width: '100%',\r\n                    height: '100%',\r\n                    background: 'rgba(0,0,0,0.9)',\r\n                    display: 'flex',\r\n                    alignItems: 'center',\r\n                    justifyContent: 'center',\r\n                    zIndex: 10001\r\n                }}>\r\n                    <div style={{\r\n                        background: 'linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f1419 100%)',\r\n                        border: '2px solid #4a90e2',\r\n                        borderRadius: '15px',\r\n                        padding: '30px',\r\n                        maxWidth: '500px',\r\n                        textAlign: 'center',\r\n                        color: 'white',\r\n                        boxShadow: '0 20px 60px rgba(0,0,0,0.8)'\r\n                    }}>\r\n                        <h2 style={{ margin: '0 0 20px 0', color: '#4a90e2', fontSize: '24px' }}>\r\n                            ðŸ’Ž Upgrade to Premium\r\n                        </h2>\r\n                        \r\n                        <div style={{ margin: '20px 0', fontSize: '18px' }}>\r\n                            <p style={{ margin: '8px 0', lineHeight: '1.5' }}>\r\n                                You've reached the <strong>{FREE_COLLECTION_LIMIT} card limit</strong> for free users!\r\n                            </p>\r\n                        </div>\r\n                        \r\n                        <div style={{\r\n                            background: 'rgba(74, 144, 226, 0.1)',\r\n                            padding: '20px',\r\n                            borderRadius: '10px',\r\n                            margin: '20px 0'\r\n                        }}>\r\n                            <h3 style={{ margin: '0 0 15px 0', color: '#4a90e2' }}>Premium Features:</h3>\r\n                            <ul style={{ textAlign: 'left', lineHeight: '1.8', margin: 0, paddingLeft: '20px' }}>\r\n                                <li>ðŸ”¥ <strong>Unlimited collection storage</strong></li>\r\n                                <li>ðŸ§  <strong>Advanced AI learning</strong></li>\r\n                                <li>ðŸ“Š <strong>Collection analytics</strong></li>\r\n                                <li>ðŸ’° <strong>Price tracking & alerts</strong></li>\r\n                                <li>ðŸŽ¯ <strong>Deck optimization tools</strong></li>\r\n                                <li>âš¡ <strong>Priority customer support</strong></li>\r\n                            </ul>\r\n                        </div>\r\n                        \r\n                        <div style={{\r\n                            display: 'flex',\r\n                            gap: '15px',\r\n                            margin: '25px 0',\r\n                            justifyContent: 'center'\r\n                        }}>\r\n                            <button \r\n                                onClick={handleUpgradeToPremium}\r\n                                style={{\r\n                                    padding: '15px 30px',\r\n                                    border: 'none',\r\n                                    borderRadius: '8px',\r\n                                    fontWeight: '600',\r\n                                    cursor: 'pointer',\r\n                                    fontSize: '16px',\r\n                                    background: 'linear-gradient(45deg, #4a90e2, #357abd)',\r\n                                    color: 'white',\r\n                                    boxShadow: '0 4px 15px rgba(74, 144, 226, 0.4)'\r\n                                }}\r\n                            >\r\n                                ðŸ’Ž Upgrade for $9.99/month\r\n                            </button>\r\n                            <button \r\n                                onClick={() => setShowPaywallModal(false)}\r\n                                style={{\r\n                                    padding: '15px 20px',\r\n                                    border: '1px solid #666',\r\n                                    borderRadius: '8px',\r\n                                    fontWeight: '600',\r\n                                    cursor: 'pointer',\r\n                                    fontSize: '16px',\r\n                                    background: 'transparent',\r\n                                    color: 'white'\r\n                                }}\r\n                            >\r\n                                Maybe Later\r\n                            </button>\r\n                        </div>\r\n                        \r\n                        <div style={{\r\n                            marginTop: '20px',\r\n                            paddingTop: '20px',\r\n                            borderTop: '1px solid #444',\r\n                            fontSize: '12px',\r\n                            color: '#ccc'\r\n                        }}>\r\n                            <p>ðŸ’³ Secure payment via PayPal</p>\r\n                            <p>ðŸ“§ Payment to: thediceyguy@gmail.com</p>\r\n                            <p>ðŸ”’ Cancel anytime, no long-term commitment</p>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            )}\r\n\r\n            {/* Continue Scanning Dialog */}\r\n            {showContinueDialog && (\r\n                <div style={{\r\n                    position: 'fixed',\r\n                    top: 0,\r\n                    left: 0,\r\n                    width: '100%',\r\n                    height: '100%',\r\n                    background: 'rgba(0,0,0,0.8)',\r\n                    display: 'flex',\r\n                    alignItems: 'center',\r\n                    justifyContent: 'center',\r\n                    zIndex: 10000\r\n                }}>\r\n                    <div style={{\r\n                        background: '#23272a',\r\n                        border: '2px solid #4a90e2',\r\n                        borderRadius: '12px',\r\n                        padding: '24px',\r\n                        maxWidth: '450px',\r\n                        textAlign: 'center',\r\n                        color: 'white',\r\n                        boxShadow: '0 8px 32px rgba(0,0,0,0.5)'\r\n                    }}>\r\n                        <h3 style={{ margin: '0 0 16px 0', color: '#4a90e2', fontSize: '20px' }}>\r\n                            ðŸ”¥ 10 Cards Scanned with Smart Cooldown!\r\n                        </h3>\r\n                        <p style={{ margin: '8px 0', lineHeight: '1.5' }}>\r\n                            You've successfully scanned <strong>10 cards</strong> with the smart cooldown system.\r\n                        </p>\r\n                        <p style={{ margin: '8px 0', lineHeight: '1.5' }}>\r\n                            AI learned <strong>{Object.keys(editionPreferences).length}</strong> edition preferences.\r\n                        </p>\r\n                        <p style={{ margin: '8px 0', lineHeight: '1.5' }}>\r\n                            Total saved to collection: <strong>{savedCards.length}</strong> cards\r\n                        </p>\r\n                        \r\n                        <div style={{\r\n                            display: 'flex',\r\n                            gap: '12px',\r\n                            margin: '20px 0',\r\n                            justifyContent: 'center'\r\n                        }}>\r\n                            <button \r\n                                onClick={handleContinueScanning}\r\n                                style={{\r\n                                    padding: '12px 20px',\r\n                                    border: 'none',\r\n                                    borderRadius: '6px',\r\n                                    fontWeight: '600',\r\n                                    cursor: 'pointer',\r\n                                    fontSize: '14px',\r\n                                    background: '#4a90e2',\r\n                                    color: 'white'\r\n                                }}\r\n                            >\r\n                                ðŸ”¥ Continue Smart Scanning\r\n                            </button>\r\n                            <button \r\n                                onClick={handleStopScanning}\r\n                                style={{\r\n                                    padding: '12px 20px',\r\n                                    border: 'none',\r\n                                    borderRadius: '6px',\r\n                                    fontWeight: '600',\r\n                                    cursor: 'pointer',\r\n                                    fontSize: '14px',\r\n                                    background: '#666',\r\n                                    color: 'white'\r\n                                }}\r\n                            >\r\n                                â¹ï¸ Stop & Review Collection\r\n                            </button>\r\n                        </div>\r\n                        \r\n                        <div style={{\r\n                            display: 'flex',\r\n                            justifyContent: 'space-around',\r\n                            marginTop: '16px',\r\n                            paddingTop: '16px',\r\n                            borderTop: '1px solid #444',\r\n                            fontSize: '12px',\r\n                            color: '#ccc'\r\n                        }}>\r\n                            <span>ðŸ”¥ Smart scans: {continuousCount}</span>\r\n                            <span>ðŸ§  AI learned: {Object.keys(editionPreferences).length}</span>\r\n                            <span>ðŸ“ Collection: {savedCards.length} total</span>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default Scanner;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}